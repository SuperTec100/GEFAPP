<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Evolução Fisioterapêutica</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --border-radius: 6px;
            --box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        h2, h3, h4 {
            color: var(--primary-color);
            margin-top: 0;
        }

        h2 {
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        h3 {
            margin: 25px 0 15px 0;
        }

        textarea {
            width: 100%;
            height: 300px;
            margin-top: 10px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            resize: vertical;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
        }

        select, input[type="text"], input[type="number"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            margin: 5px 0;
            width: 100%;
            max-width: 300px;
        }

        label {
            display: block;
            margin: 8px 0 4px 0;
            font-weight: 500;
        }

        button {
            padding: 10px 20px;
            margin-right: 10px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background-color: #2980b9;
            transform: translateY(-1px);
        }

        button:active {
            transform: translateY(0);
        }

        /* Estilos para seções expansíveis */
        .expandable-section {
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .section-header {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .section-header:hover {
            background-color: #34495e;
        }

        .section-header::after {
            content: '+';
            font-size: 18px;
            transition: transform 0.3s;
        }

        .section-header.expanded::after {
            content: '-';
        }

        .section-content {
            padding: 15px;
            display: none;
            background-color: white;
        }

        /* Estilos para grupos de checkboxes/radios */
        .checkbox-group, .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }

        .checkbox-group label, .radio-group label {
            display: flex;
            align-items: center;
            margin: 5px 0;
            cursor: pointer;
        }

        .checkbox-group input, .radio-group input {
            margin-right: 8px;
            width: auto;
        }

        /* Estilos para subseções */
        .sub-section {
            margin-left: 15px;
            padding-left: 15px;
            border-left: 2px solid #eee;
            margin-top: 10px;
        }

        /* Estilos para sinais vitais */
        .vital-signs-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .vital-sign {
            display: flex;
            flex-direction: column;
        }

        /* Estilos para mensagens de erro */
        .error-message {
            color: var(--danger-color);
            font-size: 0.9em;
            margin-top: 5px;
        }

        /* Estilos para a seção de texto gerado */
        .output-section {
            margin-top: 30px;
        }

        /* Estilos para o crédito do desenvolvedor */
        .developer-credit {
            margin-top: 30px;
            text-align: right;
            font-size: 0.9em;
            color: #7f8c8d;
            font-style: italic;
        }

        /* Estilos para EVA */
        .eva-container {
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
        }

        .eva-slider {
            width: 100%;
            max-width: 300px;
        }

        .eva-value {
            display: inline-block;
            width: 30px;
            text-align: center;
            margin-left: 10px;
            font-weight: bold;
        }

        /* Estilos responsivos */
        @media (max-width: 768px) {
            .checkbox-group, .radio-group {
                grid-template-columns: 1fr;
            }
            
            .vital-signs-container {
                grid-template-columns: 1fr;
            }
        }

        /* Estilo para campos obrigatórios */
        .required-field::after {
            content: " *";
            color: var(--danger-color);
        }

/* ESTILOS PARA SUBSECÇÕES (NOVOS) */
.sub-section {
    font-size: 1.1em;
    font-weight: bold;
    margin: 15px 0;
    padding: 10px;
    background-color: #f8f9fa;
    border-left: 4px solid var(--secondary-color);
    border-radius: var(--border-radius);
}

/* Opcional: Destaque para labels dentro de subseções */
.sub-section label {
    font-weight: 600;
}

    </style>
</head>
<body>
<div id="paciente-info" style="margin-bottom: 20px; padding: 10px; background: #eef2f5; border-radius: 6px;">
  <strong>Hospital:</strong> <span id="hospital"></span> |
  <strong>Unidade:</strong> <span id="unidade"></span> |
  <strong>Leito:</strong> <span id="leito"></span>
</div>

    <div class="container">
        <h2>Gerador de Evolução Fisioterapêutica</h2>

        <!-- Seção de informações básicas -->
        <div class="expandable-section">
            <div class="section-header"> Informações Básicas</div>
            <div class="section-content">
                <div class="tipo-evolucao">
                    <label class="required-field">Tipo:</label>
                    <select id="tipoDocumento">
                        <option value="evolucao" selected>Evolução</option>
                        <option value="admissao">Admissão</option>
                    </select>
                </div>

                <label class="required-field">UTI:</label>
<select id="uti">
    <option value="" selected disabled>Selecione</option>
    <option value="CARDIOVASCULAR">CARDIOVASCULAR</option>
    <option value="CIRÚRGICA">CIRÚRGICA</option>
    <option value="GERAL 1">GERAL 1</option>
    <option value="GERAL 2">GERAL 2</option>
    <option value="NEO">NEO</option>
    <option value="NEURO">NEURO</option>
    <option value="ONCO-HEMATO">ONCO-HEMATO</option>
    <option value="PEDI">PEDI</option>
</select>

                <label class="required-field">Data da Evolução:</label>
                <input type="text" id="dataEvolucao" placeholder="DD/MM/AAAA" 
                       pattern="(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/(19|20)\d{2}"
                       title="Digite uma data válida (DD/MM/AAAA)">

                <label class="required-field">Turno:</label>
                <select id="turno">
                    <option value="" selected disabled>Selecione</option>
                    <option value="Manhã">Manhã</option>
                    <option value="Tarde">Tarde</option>
                    <option value="Noite">Noite</option>
                </select>

<label class="required-field">Sexo:</label>
                <div class="radio-group">
                    <label><input type="radio" name="sexo" value="Masculino" checked> Masculino</label>
                    <label><input type="radio" name="sexo" value="Feminino"> Feminino</label>
                </div>

                <div id="hdaContainer" class="sub-section" style="display: none;">
                    <label>HDA (História da Doença Atual):</label>
                    <textarea id="hdaTexto" placeholder="Descreva a história da doença atual do paciente..."></textarea>
                </div>
            </div>
        </div>

        <!-- Seção de Encontrado no Leito -->
        <div class="expandable-section">
            <div class="section-header"> Encontrado no Leito</div>
            <div class="section-content">
                <label class="required-field">Posição no leito:</label>
                <select id="posicaoLeito">
                    <option value="" selected disabled>Selecione</option>
                    <option value="decúbito dorsal">Decúbito Dorsal</option>
                    <option value="decúbito lateral direito">Decúbito Lateral Direito</option>
                    <option value="decúbito lateral esquerdo">Decúbito Lateral Esquerdo</option>
                    <option value="sedestação">Sedestação</option>
                </select>

                <label>Contenção:</label>
                <div class="radio-group">
                    <label><input type="radio" name="contencao" value="Sim" onclick="mostrarOpcoesContencao()"> Sim</label>
                    <label><input type="radio" name="contencao" value="Não" onclick="mostrarOpcoesContencao()" checked> Não</label>
                </div>

                <div id="opcoesContencao" class="sub-section" style="display:none;">
                    <label>MMSS:</label>
                    <input type="checkbox" name="MMSS" value="MMSS"> Sim
                    <label>MMII:</label>
                    <input type="checkbox" name="MMII" value="MMII"> Sim
                </div>

                <!-- Avaliação de Dor -->
                <div class="sub-section">
                    <label>Avaliação de Dor:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="avaliacaoDor" value="Sim" onclick="mostrarEscalaEVA()"> Sim</label>
                        <label><input type="radio" name="avaliacaoDor" value="Não" onclick="esconderEscalaEVA()" checked> Não</label>
                    </div>

                    <div id="escalaEVAContainer" style="display:none;">
                        <div class="eva-container">
                            <label>Escala EVA (0-10):</label>
                            <input type="range" id="eva" class="eva-slider" min="0" max="10" step="1" value="0" oninput="document.getElementById('evaValue').textContent = this.value">
                            <span id="evaValue" class="eva-value">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de sinais vitais -->
        <div class="expandable-section">
            <div class="section-header"> Sinais Vitais</div>
            <div class="section-content">
                <div class="vital-signs-container">
                    <div class="vital-sign">
                        <label class="required-field">FC:</label>
                        <input type="number" id="fc" min="0">
                    </div>
                    <div class="vital-sign">
                        <label class="required-field">FR:</label>
                        <input type="number" id="fr" min="0">
                    </div>
                    <div class="vital-sign">
                        <label class="required-field">SPO2:</label>
                        <input type="number" id="spo2" min="0" max="100">
                    </div>
                    <div class="vital-sign">
                        <label class="required-field">PA:</label>
                        <input type="text" id="pa" pattern="\d{1,3}\/\d{1,3}" placeholder="Ex: 120/80" oninput="calcularPAM(this.value)">
                        <span id="pam" style="margin-left:5px;"></span>
                    </div>
                    <div class="vital-sign">
                        <label class="required-field">Temperatura:</label>
                        <input type="number" id="temp" step="0.1" min="20" max="45">
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de estado mental -->
        <div class="expandable-section">
        <div class="section-header"> Estado Mental</div>
        <div class="section-content">
            <div class="checkbox-group">
                <label><input type="checkbox" name="estadoComportamental" value="desperto"> Desperto</label>
                <label><input type="checkbox" name="estadoComportamental" value="vigil"> Vigil</label>
                <label><input type="checkbox" name="estadoComportamental" value="alerta"> Alerta</label>
                <label><input type="checkbox" name="estadoComportamental" value="sonolento"> Sonolento</label>
                <label><input type="checkbox" name="estadoComportamental" value="comatoso"> Comatoso</label>
                <label><input type="checkbox" name="estadoComportamental" value="agitado"> Agitado</label>
                <label><input type="checkbox" name="estadoComportamental" value="desorientado"> Desorientado</label>
                <label><input type="checkbox" name="estadoComportamental" value="orientado"> Orientado</label>
                <label><input type="checkbox" name="estadoComportamental" value="confuso"> Confuso</label>
                <label><input type="checkbox" name="estadoComportamental" value="responsivo"> Responsivo</label>
                <label><input type="checkbox" name="estadoComportamental" value="Narcose Anestésica"> Narcose Anestésica</label>
                <label><input type="checkbox" name="estadoComportamental" value="não Responsivo"> Não Responsivo</label>
                <label><input type="checkbox" name="estadoComportamental" value="hipoativo"> Hipoativo</label>
                
                <!-- AFASIA (só aparece na UTI Neuro) -->
                <div id="afasiaContainer" style="display:none; margin-top:15px;">
                    <label>Afasia:</label>
                    <div style="display:flex; gap:15px;">
                        <label><input type="radio" name="afasia" value="Sem" checked> Sem Afasia</label>
                        <label><input type="radio" name="afasia" value="Motora"> Motora</label>
                        <label><input type="radio" name="afasia" value="Sensitiva"> Sensitiva</label>
                        <label><input type="radio" name="afasia" value="Mista"> Mista</label>
                    </div>
                </div>
            </div>

                <label>Sedacão:</label>
                <div class="radio-group">
    <label><input type="radio" name="sedacao" value="Sim" onclick="mostrarOpcoesSedacao()"> Sim</label>
    <label><input type="radio" name="sedacao" value="Narcose Anestésica" onclick="mostrarOpcoesSedacao()"> Narcose Anestésica</label>
    <label><input type="radio" name="sedacao" value="Não" onclick="mostrarOpcoesSedacao()" checked> Não</label>
</div>

                <div id="opcoesSedacao" class="sub-section" style="display:none;">
                    <label>Sedativos:</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="sedativos" value="Bloqueador Neuromuscular"> Bloqueador Neuromuscular</label>
                        <label><input type="checkbox" name="sedativos" value="Dormonid"> Dormonid</label>
                        <label><input type="checkbox" name="sedativos" value="Fentanil"> Fentanil</label>
                        <label><input type="checkbox" name="sedativos" value="Ketamina"> Ketamina</label>
                        <label><input type="checkbox" name="sedativos" value="Midazolam"> Midazolam</label>
                        <label><input type="checkbox" name="sedativos" value="Precedex"> Precedex</label>
                        <label><input type="checkbox" name="sedativos" value="Propofol"> Propofol</label>
                    </div>

                    <label>Escala RASS:</label>
                    <select id="rass">
                        <option value="-5">-5 (Profundamente Sedado)</option>
                        <option value="-4">-4 (Sedado, mas responde a estímulos dolorosos)</option>
                        <option value="-3">-3 (Sedado, mas responde a voz)</option>
                        <option value="-2">-2 (Sedação leve, responde parcialmente)</option>
                        <option value="-1">-1 (Levemente sedado, responde completamente)</option>
                        <option value="0">0 (Completamente acordado, sem sedação)</option>
                        <option value="1">1 (Agitação leve)</option>
                        <option value="2">2 (Agitação moderada)</option>
                        <option value="3">3 (Agitação grave)</option>
                    </select>
                </div>

                <div id="opcoesGlasgow" style="display:block;">
    <label>Escala de Glasgow:</label>
    <select id="glasgow">
        <option value="" selected disabled>Selecione</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
    </select>
    <div id="glasgowComponents" style="margin-top:10px; display:none; font-size:0.9em;">
        <div style="display:flex; gap:10px;">
            <div>
                <small>Ocular</small>
                <select id="glasgowOcular" style="width:80px;">
                    <option value="4">4</option>
                    <option value="3">3</option>
                    <option value="2">2</option>
                    <option value="1">1</option>
                </select>
            </div>
            <div>
                <small>Verbal</small>
                <select id="glasgowVerbal" style="width:80px;">
                    <option value="5">5</option>
                    <option value="4">4</option>
                    <option value="3">3</option>
                    <option value="2">2</option>
                    <option value="1">1</option>
                </select>
            </div>
            <div>
                <small>Motora</small>
                <select id="glasgowMotora" style="width:80px;">
                    <option value="6">6</option>
                    <option value="5">5</option>
                    <option value="4">4</option>
                    <option value="3">3</option>
                    <option value="2">2</option>
                    <option value="1">1</option>
                </select>
            </div>
        </div>
    </div>
</div>
</div>
                </div>
         
        <!-- Seção de estado hemodinâmico -->
        <div class="expandable-section">
    <div class="section-header" Estado Hemodinâmico</div>
    <div class="section-content">
        <div class="radio-group" style="display: flex; flex-wrap: wrap; gap: 15px;">
            <label><input type="radio" name="hemodinamica" value="Hemodinâmica estável" checked> Estável</label>
            <label><input type="radio" name="hemodinamica" value="Hemodinâmica compensada"> Compensada</label>
            <label><input type="radio" name="hemodinamica" value="Hemodinâmica instável"> Instável</label>
        </div>
        
        <div class="radio-group" style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
            <label><input type="radio" name="drogasVasoativas" value="com uso de drogas vasoativas" onclick="mostrarDrogas()"> Com drogas vasoativas</label>
            <label><input type="radio" name="drogasVasoativas" value="sem uso de drogas vasoativas" onclick="mostrarDrogas()" checked> Sem drogas vasoativas</label>
        </div>

        <div id="opcoesDrogas" class="sub-section" style="display:none;">
            <label>Drogas vasoativas:</label>
            <div class="checkbox-group">
                <label><input type="checkbox" name="drogas" value="Amiodarona"> Amiodarona</label>
                <label><input type="checkbox" name="drogas" value="Ancoron"> Ancoron</label>
                <label><input type="checkbox" name="drogas" value="Dobutamina"> Dobutamina</label>
                <label><input type="checkbox" name="drogas" value="Nipride"> Nipride</label>
                <label><input type="checkbox" name="drogas" value="Noradrenalina"> Noradrenalina</label>
                <label><input type="checkbox" name="drogas" value="Tridil"> Tridil</label>
                <label><input type="checkbox" name="drogas" value="Vasopressina"> Vasopressina</label>
            </div>
        </div>
    </div>
</div>
        <!-- Seção de sistema respiratório -->
<div class="expandable-section">
    <div class="section-header"> Sistema Respiratório</div>
    <div class="section-content">
        <label class="required-field">Tipo de ventilação:</label>
        <select id="sistemaRespiratorio" onchange="atualizarOpcoesRespiratorias()">
            <option value="" selected disabled>Selecione</option>
            <option value="espontanea">Ventilação Espontânea</option>
            <option value="vni">Ventilação Não Invasiva (VNI)</option>
            <option value="VM">Ventilação Mecânica (VM)</option>
        </select>

        <!-- Via Aérea (só aparece para VM) -->
        <div id="viaAereaOptions" class="sub-section" style="display:none;">
            <label>Via Aérea:</label>
            <div class="radio-group">
                <label><input type="radio" name="viaAerea" value="TOT" onclick="mostrarCuffOptions()"> TOT (Tubo Orotraqueal)</label>
                <label><input type="radio" name="viaAerea" value="TQT" onclick="mostrarOpcoesTQT()"> TQT (Tubo Traqueal)</label>
            </div>
            
            <div id="opcoesTQT" class="sub-section" style="display:none;">
                <label>Tipo de Cânula:</label>
                <div class="radio-group">
                    <label><input type="radio" name="tipoTQT" value="Cânula Plástica Simples"> Cânula Plástica Simples</label>
                    <label><input type="radio" name="tipoTQT" value="Cânula Plástica Blue Line"> Cânula Plástica Blue Line</label>
                    <label><input type="radio" name="tipoTQT" value="Cânula Metálica"> Cânula Metálica</label>
                </div>
            </div>
            
            <div id="cuffOptions" class="sub-section" style="display:none;">
                <label>Cuff:</label>
                <div class="radio-group">
                    <label><input type="radio" name="cuff" value="Insuflado" onclick="mostrarPressaoCuff()"> Insuflado</label>
                    <label><input type="radio" name="cuff" value="Desinsuflado" onclick="esconderPressaoCuff()"> Desinsuflado</label>
                </div>
                
                <div id="pressaoCuff" class="sub-section" style="display:none;">
                    <label>P.Cuff (cmH2O):</label>
                    <input type="number" id="pcuff" min="0" max="50" step="0.1">
                    
                    <div style="margin-top: 10px;">
                        <label>Fixado em Rima Labial (cm):</label>
                        <input type="number" id="rimaLabial" min="0" max="30" step="0.1">
                    </div>
                    <div style="margin-top: 10px;">
                        <label>Número do Tubo:</label>
                        <input type="number" id="numeroTubo" min="0" max="10" step="0.5">
                    </div>
                </div>
            </div>
        </div>

        <!-- Modos Ventilatórios (só aparece para VM/VNI) -->
        <div id="opcoesRespiratorias"></div>
        
        <!-- Parâmetros de Ventilação (agora antes da mecânica pulmonar) -->
        <div id="ventilationParams" class="sub-section" style="display:none;">
            <div id="VCVParams">
                <div class="vital-sign">
                    <label>VC (ml):</label>
                    <input type="number" id="vc" min="0">
                </div>
                <div class="vital-sign">
                    <label>PEEP (cmH2O):</label>
                    <input type="number" id="peep" min="0" step="0.1">
                </div>
                <div class="vital-sign">
                    <label>FiO2 (%):</label>
                    <input type="number" id="fio2" min="21" max="100">
                </div>
                <div class="vital-sign">
                    <label>FR (ipm):</label>
                    <input type="text" id="frVent" placeholder="Ex: 24/20" pattern="\d{1,2}\/\d{1,2}">
                </div>
            </div>
            <div id="PCVParams">
                <div class="vital-sign">
                    <label>Pinsp (cmH2O):</label>
                    <input type="number" id="pinsp" min="0" step="0.1">
                </div>
                <div class="vital-sign">
                    <label>PEEP (cmH2O):</label>
                    <input type="number" id="peepPcv" min="0" step="0.1">
                </div>
                <div class="vital-sign">
                    <label>FiO2 (%):</label>
                    <input type="number" id="fio2Pcv" min="21" max="100">
                </div>
                <div class="vital-sign">
                    <label>FR (ipm):</label>
                    <input type="text" id="frPcv" placeholder="Ex: 24/20" pattern="\d{1,2}\/\d{1,2}">
                </div>
            </div>
            <div id="PSVParams">
                <div class="vital-sign">
                    <label>Psup (cmH2O):</label>
                    <input type="number" id="psup" min="0" step="0.1">
                </div>
                <div class="vital-sign">
                    <label>PEEP (cmH2O):</label>
                    <input type="number" id="peepPsv" min="0" step="0.1">
                </div>
                <div class="vital-sign">
                    <label>FiO2 (%):</label>
                    <input type="number" id="fio2Psv" min="21" max="100">
                </div>
            </div>
            <div id="SIMVParams">
                <div class="vital-sign">
                    <label>VC (ml):</label>
                    <input type="number" id="vcSimv" min="0">
                </div>
                <div class="vital-sign">
                    <label>Psup (cmH2O):</label>
                    <input type="number" id="psupSimv" min="0" step="0.1">
                </div>
                <div class="vital-sign">
                    <label>PEEP (cmH2O):</label>
                    <input type="number" id="peepSimv" min="0" step="0.1">
                </div>
                <div class="vital-sign">
                    <label>FR (ipm):</label>
                    <input type="number" id="frSimv" min="0">
                </div>
                <div class="vital-sign">
                    <label>FiO2 (%):</label>
                    <input type="number" id="fio2Simv" min="21" max="100">
                </div>
            </div>
        </div>

        <!-- Mecânica Pulmonar (agora depois dos parâmetros) -->
        <div id="mecanicaPulmonarContainer" class="sub-section" style="display:none;">
            <label>Mecânica Pulmonar:</label>
            <div class="radio-group">
                <label><input type="radio" name="mecanicaPulmonar" value="Sim" onclick="mostrarMecanicaPulmonar()"> Sim</label>
                <label><input type="radio" name="mecanicaPulmonar" value="Não" onclick="esconderMecanicaPulmonar()" checked> Não</label>
            </div>
            
            <div id="detalhesMecanicaPulmonar" style="display:none; margin-top:10px;">
                <div class="vital-signs-container">
                    <div class="vital-sign">
                        <label>Complacência (ml/cmH2O):</label>
                        <input type="number" id="Complacência" min="0" step="0.1">
                    </div>
                    <div class="vital-sign">
                        <label>Resistência (cmH2O/L/s):</label>
                        <input type="number" id="resistencia" min="0" step="0.1">
                    </div>
                    <div class="vital-sign">
                        <label>Pressão de Platô (cmH2O):</label>
                        <input type="number" id="pressaoPlato" min="0" step="0.1">
                    </div>
                    <div class="vital-sign">
                        <label>Pressão de Pico (cmH2O):</label>
                        <input type="number" id="pressaoPico" min="0" step="0.1">
                    </div>
                    <div class="vital-sign">
                        <label>Auto-PEEP (cmH2O):</label>
                        <input type="number" id="autoPEEP" min="0" step="0.1">
                    </div>
                    <div class="vital-sign">
    <label>Drive Pressure (cmH2O):</label>
    <input type="number" id="drivePressure" min="0" step="0.1">
</div>
                </div>
            </div>
        </div>

        <div id="fluxoContainer" class="sub-section" style="display:none;">
            <label>Fluxo (L/min):</label>
            <input type="number" id="fluxo" min="1" max="60">
            <div id="fio2CNAFContainer" style="display:none; margin-top:10px;">
                <label>FiO₂ (%):</label>
                <input type="number" id="fio2CNAF" min="21" max="100" value="21">
            </div>
            <div id="roxContainer" style="display:none; margin-top:10px;">
                <label>Índice ROX:</label>
                <span id="roxValue">-</span>
                <span id="roxInterpretation"></span>
            </div>
        </div>

        <div class="sub-section">
            <label>Padrão Respiratório:</label>
            <div class="radio-group">
                <label><input type="radio" name="respPattern" value="Eupneia" checked> Eupneia</label>
                <label><input type="radio" name="respPattern" value="Taquipneia"> Taquipneia</label>
                <label><input type="radio" name="respPattern" value="Bradipneia"> Bradipneia</label>
                <label><input type="radio" name="respPattern" value="Dispneia"> Dispneia</label>
                <label><input type="radio" name="respPattern" value="Apneia"> Apneia</label>
                <label><input type="radio" name="respPattern" value="Cheyne-Stokes"> Cheyne-Stokes</label>
                <label><input type="radio" name="respPattern" value="Biot"> Biot</label>
                <label><input type="radio" name="respPattern" value="Kussmaul"> Kussmaul</label>
            </div>
        </div>

        <div class="sub-section">
            <label>Tosse:</label>
            <div class="radio-group">
                <label><input type="radio" name="tosse" value="Eficaz" onclick="mostrarTipoTosse()" checked> Eficaz</label>
                <label><input type="radio" name="tosse" value="Débil" onclick="mostrarTipoTosse()"> Débil</label>
                <label><input type="radio" name="tosse" value="Ineficaz" onclick="esconderTipoTosse()"> Ineficaz</label>
                <label><input type="radio" name="tosse" value="Ausente" onclick="esconderTipoTosse()"> Ausente</label>
            </div>
            
            <div id="tipoTosse" class="sub-section" style="display: block;">
                <label>Tipo:</label>
                <div class="radio-group">
                    <label><input type="radio" name="tipoTosse" value="Produtiva" checked> Produtiva</label>
                    <label><input type="radio" name="tipoTosse" value="Úmida"> Úmida</label>
                    
                    <label><input type="radio" name="tipoTosse" value="Seca"> Seca</label>
                </div>
            </div>
        </div>

        <div class="sub-section">
    <label>Padrão Muscular Ventilatório (PMV):</label>
    <div class="radio-group">
        <label><input type="radio" name="pmv" value="Diafragmático"> Diafragmático</label>
        <label><input type="radio" name="pmv" value="Abdominal"> Abdominal</label>
        <label><input type="radio" name="pmv" value="Costodiafragmático" checked> Costodiafragmático</label>
        <label><input type="radio" name="pmv" value="Paradoxal"> Paradoxal</label>
        <label><input type="radio" name="pmv" value="Acessório"> Acessório</label>
    </div>
    <div id="trabalhoRespiratorioContainer" class="sub-section" style="display:block;">
        <label>Trabalho Respiratório:</label>
        <div class="radio-group">
            <label><input type="radio" name="trabalhoRespiratorio" value="Com aumento de trabalho respiratório"> Com aumento</label>
            <label><input type="radio" name="trabalhoRespiratorio" value="Sem sinais de aumento de trabalho respiratório" checked> Sem aumento</label>
        </div>
    </div>
</div>

        <div class="sub-section">
            <label>Expansibilidade Torácica:</label>
            <div class="radio-group">
                <label><input type="radio" name="expansibilidade" value="Simétrica" onclick="hideLungOptions()" checked> Simétrica</label>
                <label><input type="radio" name="expansibilidade" value="Diminuída" onclick="showLungOptions()"> Diminuída</label>
                <label><input type="radio" name="expansibilidade" value="Assimétrica" onclick="showLungOptions()"> Assimétrica</label>
                <label><input type="radio" name="expansibilidade" value="Ausente" onclick="hideLungOptions()"> Ausente</label>
            </div>
            <div id="lungOptions" class="sub-section" style="display:none;">
                <label>Local:</label>
                <div class="radio-group">
                    <label><input type="radio" name="lungSide" value="Direito"> Direito</label>
                    <label><input type="radio" name="lungSide" value="Esquerdo"> Esquerdo</label>
                    <label><input type="radio" name="lungSide" value="Bilateral"> Bilateral</label>
                </div>
            </div>
        </div>

        <div class="sub-section">
            <label>Ausculta Pulmonar:</label>
            <div class="radio-group">
                <label><input type="radio" name="ausculta" value="Sons audíveis" onclick="mostrarOpcoesRuidos()" checked> Sons audíveis</label>
                <label><input type="radio" name="ausculta" value="Sons reduzidos" onclick="mostrarOpcoesRuidos()"> Sons reduzidos</label>
                <label><input type="radio" name="ausculta" value="Sons ausentes" onclick="mostrarOpcoesRuidos()"> Sons ausentes</label>
            </div>
            
            <div id="opcoesRuidos" style="margin-top:10px;">
                <div id="sonsReduzidosOptions" class="sub-section" style="display:none;">
                    <label>Localização:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="auscultaSide" value="Bilateralmente" checked> Bilateralmente</label>
                        <label><input type="radio" name="auscultaSide" value="Pulmão Direito"> Pulmão Direito</label>
                        <label><input type="radio" name="auscultaSide" value="Pulmão Esquerdo"> Pulmão Esquerdo</label>
                        <label><input type="radio" name="auscultaSide" value="Ápice"> Ápice</label>
                        <label><input type="radio" name="auscultaSide" value="Base"> Base</label>
                    </div>
                </div>
                
                <label>Ruídos:</label>
                <div class="radio-group">
                    <label><input type="radio" name="ruidos" value="com ruídos" onclick="mostrarTiposRuidos()"> Com ruídos</label>
                    <label><input type="radio" name="ruidos" value="sem ruídos" onclick="esconderTiposRuidos()"> Sem ruídos</label>
                </div>
                
                <div id="tiposRuidos" class="sub-section" style="display:none;">
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="tipoRuido" value="Roncos" onclick="mostrarOpcoesRuidos()"> Roncos</label>
                        <label><input type="checkbox" name="tipoRuido" value="Sibilos"> Sibilos</label>
                        <label><input type="checkbox" name="tipoRuido" value="Estridores"> Estridores</label>
                        <label><input type="checkbox" name="tipoRuido" value="Estertores"> Estertores</label>
                        <label><input type="checkbox" name="tipoRuido" value="Atrito pleural"> Atrito pleural</label>
                    </div>
                    </div>
            </div>
                    <div class="sub-section">
    <label>Observações Adicionais (Respiratório):</label>
    <textarea id="obsRespiratorio" placeholder="Adicione observações sobre o sistema respiratório..." style="height: 80px;"></textarea>
</div>
        </div>

<!-- Marcos Respiratórios -->
<div class="sub-section">
    <label>Marcos Respiratórios:</label>
    <textarea id="marcosRespiratorios" placeholder="Ex: IOT(21/03), TQT (28/03), Data de Extubação..." style="height: 80px;"></textarea>
</div>

    </div>
</div>

<!-- Seção de mecânica ventilatória -->
<div class="expandable-section">
    <div class="section-header"> Avaliação da Função Respiratória</div>
    <div class="section-content">
        <!-- Subseção de Monovacuometria -->
        <div class="expandable-section">
            <div class="section-header">Monovacuometria</div>
            <div class="section-content">
                <div class="vital-signs-container">
                    <div class="vital-sign">
                        <label>PiMax (cmH2O):</label>
                        <input type="number" id="pimax" min="0" step="0.1">
                    </div>
                    <div class="vital-sign">
                        <label>PeMax (cmH2O):</label>
                        <input type="number" id="pemax" min="0" step="0.1">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Subseção de Ventilometria -->
        <div class="expandable-section">
            <div class="section-header">Ventilometria</div>
            <div class="section-content">
                <div class="vital-signs-container">
                    <div class="vital-sign">
                        <label>Volume Corrente (ml):</label>
                        <input type="number" id="vcVentilometria" min="0">
                    </div>
                    <div class="vital-sign">
                        <label>Frequência Respiratória (irpm):</label>
                        <input type="number" id="frVentilometria" min="0">
                    </div>
                    <div class="vital-sign">
                        <label>Volume Minuto (L/min):</label>
                        <input type="number" id="vm" min="0" step="0.1" readonly>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        <!-- Seção de hemogasometria -->
        <div class="expandable-section">
            <div class="section-header"> Hemogasometria Arterial</div>
            <div class="section-content">
                <label>Realizada HGA:</label>
                <div class="radio-group">
                    <label><input type="radio" name="hga" value="Com HGA" onclick="mostrarCamposHGA()"> Com HGA</label>
                    <label><input type="radio" name="hga" value="Sem HGA" onclick="esconderCamposHGA()" checked> Sem HGA</label>
                </div>
                
                <div id="camposHGA" class="sub-section" style="display:none;">
                    <div class="vital-signs-container">
                        <div class="vital-sign">
                            <label>pH:</label>
                            <input type="number" id="ph" step="0.01" min="6.8" max="7.8">
                        </div>
                        <div class="vital-sign">
                            <label>PaO2:</label>
                            <input type="number" id="pao2" min="0">
                        </div>
                        <div class="vital-sign">
                            <label>PCO2:</label>
                            <input type="number" id="pco2" min="0">
                        </div>
                        <div class="vital-sign">
                            <label>HCO3:</label>
                            <input type="number" id="hco3" min="0">
                        </div>
                        <div class="vital-sign">
                            <label>Lac:</label>
                            <input type="number" id="lac" step="0.1" min="0">
                        </div>
                        <div class="vital-sign">
                            <label>P/F:</label>
                            <input type="number" id="pf" min="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de condição neuro musculoesquelética -->
        <div class="expandable-section">
            <div class="section-header"> Condição Neuro Musculoesquelética</div>
            <div class="section-content">
                <div class="sub-section">
                    <label>Amplitude de Movimento:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="amplitudeMovimento" value="Preservadas" onclick="esconderLocalizacaoADM()" checked> Preservadas</label>
                        <label><input type="radio" name="amplitudeMovimento" value="Reduzidas" onclick="mostrarLocalizacaoADM()"> Reduzidas</label>
                    </div>
                    
                    <div id="localizacaoADM" class="sub-section" style="display:none;">
                        <div class="vital-signs-container">
                            <div class="vital-sign">
                                <label>MSD:</label>
                                <select name="admMSD">
                                    <option value="ADM Normal">ADM Normal</option>
                                    <option value="ADM Levemente Reduzida">ADM Levemente Reduzida</option>
                                    <option value="ADM Moderadamente Reduzida">ADM Moderadamente Reduzida</option>
                                    <option value="ADM Severamente Reduzida">ADM Severamente Reduzida</option>
                                    <option value="Anquilose ou ADM Ausente">Anquilose ou ADM Ausente</option>
                                </select>
                            </div>
                            <div class="vital-sign">
                                <label>MSE:</label>
                                <select name="admMSE">
                                    <option value="ADM Normal">ADM Normal</option>
                                    <option value="ADM Levemente Reduzida">ADM Levemente Reduzida</option>
                                    <option value="ADM Moderadamente Reduzida">ADM Moderadamente Reduzida</option>
                                    <option value="ADM Severamente Reduzida">ADM Severamente Reduzida</option>
                                    <option value="Anquilose ou ADM Ausente">Anquilose ou ADM Ausente</option>
                                </select>
                            </div>
                            <div class="vital-sign">
                                <label>MID:</label>
                                <select name="admMID">
                                    <option value="ADM Normal">ADM Normal</option>
                                    <option value="ADM Levemente Reduzida">ADM Levemente Reduzida</option>
                                    <option value="ADM Moderadamente Reduzida">ADM Moderadamente Reduzida</option>
                                    <option value="ADM Severamente Reduzida">ADM Severamente Reduzida</option>
                                    <option value="Anquilose ou ADM Ausente">Anquilose ou ADM Ausente</option>
                                </select>
                            </div>
                            <div class="vital-sign">
                                <label>MIE:</label>
                                <select name="admMIE">
                                    <option value="ADM Normal">ADM Normal</option>
                                    <option value="ADM Levemente Reduzida">ADM Levemente Reduzida</option>
                                    <option value="ADM Moderadamente Reduzida">ADM Moderadamente Reduzida</option>
                                    <option value="ADM Severamente Reduzida">ADM Severamente Reduzida</option>
                                    <option value="Anquilose ou ADM Ausente">Anquilose ou ADM Ausente</option>
                                </select>
                            </div>
                            <div class="vital-sign">
                                <label>Tronco:</label>
                                <select name="admTronco">
                                    <option value="ADM Normal">ADM Normal</option>
                                    <option value="ADM Levemente Reduzida">ADM Levemente Reduzida</option>
                                    <option value="ADM Moderadamente Reduzida">ADM Moderadamente Reduzida</option>
                                    <option value="ADM Severamente Reduzida">ADM Severamente Reduzida</option>
                                    <option value="Anquilose ou ADM Ausente">Anquilose ou ADM Ausente</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sub-section">
                    <label>Amputações:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="amputacao" value="Sim" onclick="mostrarOpcoesAmputacao()"> Sim</label>
                        <label><input type="radio" name="amputacao" value="Não" onclick="esconderOpcoesAmputacao()" checked> Não</label>
                    </div>
                    
                    <div id="opcoesAmputacao" class="sub-section" style="display:none;">
                        <label>Tipo e Localização:</label>
                        <div class="vital-signs-container">
                            <div class="vital-sign">
                                <label><input type="checkbox" name="localAmputacao" value="MSD"> Membro Superior Direito</label>
                                <select name="tipoAmputacaoMSD">
                                    <option value="">Selecione o tipo</option>
                                    <option value="Dedo(s)">Dedo(s)</option>
                                    <option value="Mão">Mão</option>
                                    <option value="Antebraço">Antebraço</option>
                                    <option value="Braço">Braço</option>
                                </select>
                            </div>
                            <div class="vital-sign">
                                <label><input type="checkbox" name="localAmputacao" value="MSE"> Membro Superior Esquerdo</label>
                                <select name="tipoAmputacaoMSE">
                                    <option value="">Selecione o tipo</option>
                                    <option value="Dedo(s)">Dedo(s)</option>
                                    <option value="Mão">Mão</option>
                                    <option value="Antebraço">Antebraço</option>
                                    <option value="Braço">Braço</option>
                                </select>
                            </div>
                            <div class="vital-sign">
                                <label><input type="checkbox" name="localAmputacao" value="MID"> Membro Inferior Direito</label>
                                <select name="tipoAmputacaoMID">
                                    <option value="">Selecione o tipo</option>
                                    <option value="Dedo(s)">Dedo(s)</option>
                                    <option value="Pé">Pé</option>
                                    <option value="Transtibial">Transtibial</option>
                                    <option value="Transfemoral">Transfemoral</option>
                                    <option value="Hemipelvectomia">Hemipelvectomia</option>
                                </select>
                            </div>
                            <div class="vital-sign">
                                <label><input type="checkbox" name="localAmputacao" value="MIE"> Membro Inferior Esquerdo</label>
                                <select name="tipoAmputacaoMIE">
                                    <option value="">Selecione o tipo</option>
                                    <option value="Dedo(s)">Dedo(s)</option>
                                    <option value="Pé">Pé</option>
                                    <option value="Transtibial">Transtibial</option>
                                    <option value="Transfemoral">Transfemoral</option>
                                    <option value="Hemipelvectomia">Hemipelvectomia</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sub-section">
                    <label>Avaliar Força Muscular:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="forcaMuscular" value="MRC" onclick="mostrarOpcoesMRC()" checked> MRC</label>
                        <label><input type="radio" name="forcaMuscular" value="NaoPossivelAvaliar" onclick="mostrarMotivosNaoAvaliar()"> Não Possível Avaliar</label>
                    </div>
                    
                    <div id="opcoesMRC" class="sub-section" style="display:block;">
                        <div class="vital-sign">
                            <label>Total MRC:</label>
                            <input type="number" id="totalMRCInput" min="0" max="60" onchange="atualizarInterpretacaoMRC(this.value)">
                            <span>/60</span>
                        </div>
                        <div id="mrcInterpretation" style="font-style: italic; color: #555;">Paralisia total</div>
                    </div>
                    
                    <div id="motivosNaoAvaliar" class="sub-section" style="display:none;">
                        <label>Motivo:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="motivoNaoAvaliar" value="Secundário Nível de Consciência"> Secundário Nível de Consciência</label>
                            <label><input type="checkbox" name="motivoNaoAvaliar" value="Secundário Nível de Colaboração"> Secundário Nível de Colaboração</label>
                            <label><input type="checkbox" name="motivoNaoAvaliar" value="Por Recusa"> Por Recusa</label>
                            <label><input type="checkbox" name="motivoNaoAvaliar" value="Secundário Restrição ao Leito"> Secundário Restrição ao Leito</label>
                        </div>
                    </div>
                </div>

                <div class="sub-section">
                    <label>Presença de Déficit Motor:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="deficitMotor" value="Sim" onclick="mostrarOpcoesDeficitMotor()"> Sim</label>
                        <label><input type="radio" name="deficitMotor" value="Não" onclick="esconderOpcoesDeficitMotor()" checked> Não</label>
                        <label><input type="radio" name="deficitMotor" value="Não Avaliado" onclick="esconderOpcoesDeficitMotor()"> Não Avaliado</label>
                    </div>
                    
                    <div id="opcoesDeficitMotor" class="sub-section" style="display:none;">
                        <div class="sub-section">
    <label>Alteração no Tônus:</label>
    <div class="radio-group">
        <label><input type="radio" name="alteracaoTonus" value="Sem alteração" checked onclick="document.getElementById('localTonus').style.display='none'"> Sem alteração</label>
        <label><input type="radio" name="alteracaoTonus" value="Hipotonus" onclick="document.getElementById('localTonus').style.display='block'"> Hipotonus</label>
        <label><input type="radio" name="alteracaoTonus" value="Hipertonus" onclick="document.getElementById('localTonus').style.display='block'"> Hipertonus</label>
    </div>
    
    <div id="localTonus" style="display:none; margin-top:10px;">
        <label>Onde?</label>
        <div style="display:flex; gap:15px;">
            <label><input type="checkbox" name="localTonus" value="MSD"> Braço D</label>
            <label><input type="checkbox" name="localTonus" value="MSE"> Braço E</label>
            <label><input type="checkbox" name="localTonus" value="MID"> Perna D</label>
            <label><input type="checkbox" name="localTonus" value="MIE"> Perna E</label>
            <label><input type="checkbox" name="localTonus" value="Tronco"> Tronco</label>
        </div>
    </div>
</div>
                        
                        <div class="sub-section">
                            <label>Alterações no Controle Motor:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="alteracaoControleMotor" value="Sem alteração" checked onclick="esconderLocalizacoesMotoras()"> Sem alteração</label>
                                <label><input type="radio" name="alteracaoControleMotor" value="Plegia" onclick="mostrarLocalizacaoParalisia()"> Plegia</label>
                                <label><input type="radio" name="alteracaoControleMotor" value="Paresia" onclick="mostrarLocalizacaoFraqueza()"> Paresia</label>
                            </div>
                            
                            <div id="localizacaoParalisia" class="sub-section" style="display:none;">
    <label>Localização da paralisia completa:</label>
    <div class="checkbox-group">
        <!-- MSD -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localParalisia" value="MSD" onclick="toggleArticulacoes(this, 'MSD')"> MSD</label>
            </div>
            <div class="section-content" id="articulacoesMSD" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoMSD" value="ombro"> Ombro</label>
                    <label><input type="checkbox" name="articulacaoMSD" value="cotovelo"> Cotovelo</label>
                    <label><input type="checkbox" name="articulacaoMSD" value="punho"> Punho</label>
                    <label><input type="checkbox" name="articulacaoMSD" value="mão"> Mão</label>
                    <label><input type="checkbox" name="articulacaoMSD" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- MSE -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localParalisia" value="MSE" onclick="toggleArticulacoes(this, 'MSE')"> MSE </label>
            </div>
            <div class="section-content" id="articulacoesMSE" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoMSE" value="ombro"> Ombro</label>
                    <label><input type="checkbox" name="articulacaoMSE" value="cotovelo"> Cotovelo</label>
                    <label><input type="checkbox" name="articulacaoMSE" value="punho"> Punho</label>
                    <label><input type="checkbox" name="articulacaoMSE" value="mão"> Mão</label>
                    <label><input type="checkbox" name="articulacaoMSE" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- MID -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localParalisia" value="MID" onclick="toggleArticulacoes(this, 'MID')"> MID </label>
            </div>
            <div class="section-content" id="articulacoesMID" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoMID" value="quadril"> Quadril</label>
                    <label><input type="checkbox" name="articulacaoMID" value="joelho"> Joelho</label>
                    <label><input type="checkbox" name="articulacaoMID" value="tornozelo"> Tornozelo</label>
                    <label><input type="checkbox" name="articulacaoMID" value="pé"> Pé</label>
                    <label><input type="checkbox" name="articulacaoMID" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- MIE -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localParalisia" value="MIE" onclick="toggleArticulacoes(this, 'MIE')"> MIE </label>
            </div>
            <div class="section-content" id="articulacoesMIE" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoMIE" value="quadril"> Quadril</label>
                    <label><input type="checkbox" name="articulacaoMIE" value="joelho"> Joelho</label>
                    <label><input type="checkbox" name="articulacaoMIE" value="tornozelo"> Tornozelo</label>
                    <label><input type="checkbox" name="articulacaoMIE" value="pé"> Pé</label>
                    <label><input type="checkbox" name="articulacaoMIE" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- Tronco -->
        <label><input type="checkbox" name="localParalisia" value="Tronco"> Tronco</label>
    </div>
</div>

<div id="localizacaoFraqueza" class="sub-section" style="display:none;">
    <label>Localização da fraqueza parcial do movimento:</label>
    <div class="checkbox-group">
        <!-- MSD -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localFraqueza" value="MSD" onclick="toggleArticulacoes(this, 'MSD', 'Fraqueza')"> MSD </label>
            </div>
            <div class="section-content" id="articulacoesFraquezaMSD" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoFraquezaMSD" value="ombro"> Ombro</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSD" value="cotovelo"> Cotovelo</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSD" value="punho"> Punho</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSD" value="mão"> Mão</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSD" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- MSE -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localFraqueza" value="MSE" onclick="toggleArticulacoes(this, 'MSE', 'Fraqueza')"> MSE </label>
            </div>
            <div class="section-content" id="articulacoesFraquezaMSE" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoFraquezaMSE" value="ombro"> Ombro</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSE" value="cotovelo"> Cotovelo</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSE" value="punho"> Punho</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSE" value="mão"> Mão</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMSE" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- MID -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localFraqueza" value="MID" onclick="toggleArticulacoes(this, 'MID', 'Fraqueza')"> MID </label>
            </div>
            <div class="section-content" id="articulacoesFraquezaMID" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoFraquezaMID" value="quadril"> Quadril</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMID" value="joelho"> Joelho</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMID" value="tornozelo"> Tornozelo</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMID" value="pé"> Pé</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMID" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- MIE -->
        <div class="expandable-section">
            <div class="section-header">
                <label><input type="checkbox" name="localFraqueza" value="MIE" onclick="toggleArticulacoes(this, 'MIE', 'Fraqueza')"> MIE </label>
            </div>
            <div class="section-content" id="articulacoesFraquezaMIE" style="display:none;">
                <label>Articulações:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="articulacaoFraquezaMIE" value="quadril"> Quadril</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMIE" value="joelho"> Joelho</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMIE" value="tornozelo"> Tornozelo</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMIE" value="pé"> Pé</label>
                    <label><input type="checkbox" name="articulacaoFraquezaMIE" value="dedos"> Dedos</label>
                </div>
            </div>
        </div>
        
        <!-- Tronco -->
        <label><input type="checkbox" name="localFraqueza" value="Tronco"> Tronco</label>
    </div>
</div>

                        </div>
                    </div>
                </div>
                
                <div class="sub-section">
                    <label>Presença de Déficit Sensorial:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="deficitSensorial" value="Sim" onclick="mostrarOpcoesDeficitSensorial()"> Sim</label>
                        <label><input type="radio" name="deficitSensorial" value="Não" onclick="esconderOpcoesDeficitSensorial()" checked> Não</label>
                        <label><input type="radio" name="deficitSensorial" value="Não Avaliado" onclick="esconderOpcoesDeficitSensorial()"> Não Avaliado</label>
                    </div>
                    
                    <div id="opcoesDeficitSensorial" class="sub-section" style="display:none;">
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="deficitSensorialTipo" value="Propriocepção alterada" onclick="mostrarLocalizacaoPropriocepcao()"> Propriocepção alterada</label>
                            <label><input type="checkbox" name="deficitSensorialTipo" value="Cinetesia prejudicada" onclick="mostrarLocalizacaoCinetesia()"> Cinetesia prejudicada</label>
                            <label><input type="checkbox" name="deficitSensorialTipo" value="Barognosia alterada" onclick="mostrarLocalizacaoBarognosia()"> Barognosia alterada</label>
                        </div>
                        
                        <div id="localizacaoPropriocepcao" class="sub-section" style="display:none;">
                            <label>Localização:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="localPropriocepcao" value="MSD"> MSD</label>
                                <label><input type="checkbox" name="localPropriocepcao" value="MSE"> MSE</label>
                                <label><input type="checkbox" name="localPropriocepcao" value="MID"> MID</label>
                                <label><input type="checkbox" name="localPropriocepcao" value="MIE"> MIE</label>
                                <label><input type="checkbox" name="localPropriocepcao" value="Tronco"> Tronco</label>
                            </div>
                        </div>
                        
                        <div id="localizacaoCinetesia" class="sub-section" style="display:none;">
                            <label>Localização:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="localCinetesia" value="MSD"> MSD</label>
                                <label><input type="checkbox" name="localCinetesia" value="MSE"> MSE</label>
                                <label><input type="checkbox" name="localCinetesia" value="MID"> MID</label>
                                <label><input type="checkbox" name="localCinetesia" value="MIE"> MIE</label>
                                <label><input type="checkbox" name="localCinetesia" value="Tronco"> Tronco</label>
                            </div>
                        </div>
                        
                        <div id="localizacaoBarognosia" class="sub-section" style="display:none;">
                            <label>Localização:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="localBarognosia" value="MSD"> MSD</label>
                                <label><input type="checkbox" name="localBarognosia" value="MSE"> MSE</label>
                                <label><input type="checkbox" name="localBarognosia" value="MID"> MID</label>
                                <label><input type="checkbox" name="localBarognosia" value="MIE"> MIE</label>
                                <label><input type="checkbox" name="localBarognosia" value="Tronco"> Tronco</label>
                                </div>
                             </div>
                          </div>
                         <div class="sub-section">
    <label>Observações Adicionais (Neuro Musculoesquelético):</label>
    <textarea id="obsNeuroMusculo" placeholder="Adicione observações sobre a condição neuro musculoesquelética..." style="height: 80px;"></textarea>
</div>
                       </div>
                    </div>
                </div>

        <!-- Seção de aparelho cardiovascular -->
        <div class="expandable-section">
            <div class="section-header"> Aparelho Cardiovascular</div>
            <div class="section-content">
                <div class="sub-section">
                    <label>Perfusão Periférica:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="perfusao" value="Preservada" checked> Preservada</label>
                        <label><input type="radio" name="perfusao" value="Diminuída"> Diminuída</label>
                        <label><input type="radio" name="perfusao" value="Ausente"> Ausente</label>
                    </div>
                </div>
                
                <div class="sub-section">
                    <label>Edema:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="edema" value="Ausente" onclick="esconderDetalhesEdema()" checked> Ausente</label>
                        <label><input type="radio" name="edema" value="Presente" onclick="mostrarDetalhesEdema()"> Presente</label>
                    </div>
                    
                    <div id="detalhesEdema" class="sub-section" style="display:none;">
                        <label>Grau:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="grauEdema" value="+1/+4"> +1 (Leve depressão, 2mm)</label>
                            <label><input type="radio" name="grauEdema" value="+2/+4"> +2 (Moderada depressão, 4mm)</label>
                            <label><input type="radio" name="grauEdema" value="+3/+4"> +3 (Profunda depressão, 6mm)</label>
                            <label><input type="radio" name="grauEdema" value="+4/+4"> +4 (Muito profunda, 8mm)</label>
                        </div>
                        
                        <label style="margin-top:10px;">Localização:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="localEdema" value="MMII"> MMII</label>
                            <label><input type="checkbox" name="localEdema" value="MMSS"> MMSS</label>
                            <label><input type="checkbox" name="localEdema" value="Face"> Face</label>
                            <label><input type="checkbox" name="localEdema" value="Generalizado"> Generalizado</label>
                        </div>
                    </div>
                </div>
                
                <div class="sub-section">
                    <label>Outros:</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="outrosCardio" value="Pulsos periféricos presentes"> Pulsos periféricos presentes</label>
                        <label><input type="checkbox" name="outrosCardio" value="Pulsos periféricos diminuídos"> Pulsos periféricos diminuídos</label>
                        <label><input type="checkbox" name="outrosCardio" value="Pulsos periféricos ausentes"> Pulsos periféricos ausentes</label>
                        <label><input type="checkbox" name="outrosCardio" value="Turgência jugular aumentada"> Turgência jugular aumentada</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de capacidade funcional -->
        <div class="expandable-section">
            <div class="section-header"> Capacidade Funcional</div>
            <div class="section-content">
                <div class="sub-section">
                    <label>Capacidade funcional prévia ao internamento:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="capacidadePrevia" value="Previamente Independente comunitário" checked> Independente comunitário</label>
                        <label><input type="radio" name="capacidadePrevia" value="Previamente Independente domiciliar"> Independente domiciliar</label>
                        <label><input type="radio" name="capacidadePrevia" value="Previamente Acamado"> Acamado</label>
                        <label><input type="radio" name="capacidadePrevia" value="Sem informações da Funcionalidade Previa"> Sem informações</label>
                    </div>
                </div>

                <div class="sub-section">
                    <label>Capacidade Funcional Atual:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="escalaFSS" value="Aplicavel" onclick="mostrarEscalaFSS()" checked> Escala FSS</label>
                        <label><input type="radio" name="escalaFSS" value="NaoAplicavel" onclick="mostrarMotivosNaoAplicarFSS()"> Não possível aplicar</label>
                    </div>
                    
                    <div id="opcoesFSS" style="margin-top:10px;">
                        <div class="vital-sign">
                            <label>Escala FSS (0-35):</label>
                            <input type="number" id="fssScore" min="0" max="35" onchange="atualizarInterpretacaoFSS(this.value)">
                        </div>
                        <div id="fssInterpretation" style="font-style: italic; color: #555;">Independente</div>
                    </div>
                    
                    <div id="motivosNaoAplicarFSS" class="sub-section" style="display:none;">
                        <label>Motivo:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="motivoNaoAplicarFSS" value="Secundário Nível de Consciência"> Secundário Nível de Consciência</label>
                            <label><input type="checkbox" name="motivoNaoAplicarFSS" value="Secundário Nível de Colaboração"> Secundário Nível de Colaboração</label>
                            <label><input type="checkbox" name="motivoNaoAplicarFSS" value="Por Recusa"> Por Recusa</label>
                            <label><input type="checkbox" name="motivoNaoAplicarFSS" value="Secundário Restrição ao Leito"> Secundário Restrição ao Leito</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de plano terapêutico -->
        <div class="expandable-section">
            <div class="section-header"> Plano Terapêutico</div>
            <div class="section-content">
                <div class="checkbox-group">
                    <label><input type="checkbox" name="planoTerapeutico" value="Manter/Recuperar Função Respiratória"> Manter/Recuperar Função Respiratória</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Otimizar Volumes e Capacidades Pulmonares"> Otimizar Volumes e Capacidades Pulmonares</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Melhoria da Força Muscular e Mobilidade"> Melhoria da Força Muscular e Mobilidade</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Prevenir Complicações Motoras"> Prevenir Complicações Motoras</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Prevenir Complicações Respiratórias"> Prevenir Complicações Respiratórias</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Melhorar Tolerância ao Exercício"> Melhorar Tolerância ao Exercício</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Otimizar Padrão Ventilatório"> Otimizar Padrão Ventilatório</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Promover Independência Funcional"> Promover Independência Funcional</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Reduzir Tempo de Desmame Ventilatório"> Reduzir Tempo de Desmame Ventilatório</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Manter Permeabilidade de Vias Aéreas"> Manter Permeabilidade de Vias Aéreas</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Prevenir Atrofia Muscular"> Prevenir Atrofia Muscular</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Melhorar Oxigenação"> Melhorar Oxigenação</label>
                    <label><input type="checkbox" name="planoTerapeutico" value="Proporcionar Medidas para Conforto"> Proporcionar Medidas para Conforto</label>
                </div>
            </div>
        </div>

        <!-- Seção de condutas -->
<div class="expandable-section">
    <div class="section-header"> Condutas</div>
    <div class="section-content">
        <!-- Monitorização -->
        <div class="sub-section">
            <h4>Monitorização</h4>
            <div class="checkbox-group">
                <label><input type="checkbox" name="condutaMonitorizacao" value="Monitorização Cardiorrespiratória"> Monitorização Cardiorrespiratória</label>
                <label><input type="checkbox" name="condutaMonitorizacao" value="Monitorização Neurológica"> Monitorização Neurológica</label>
            </div>
        </div>
        
        <!-- Avaliações -->
        <div class="sub-section">
            <h4>Avaliações</h4>
            <div class="checkbox-group">
                <label><input type="checkbox" name="condutaAvaliacao" value="Avaliação Respiratória"> Avaliação Respiratória</label>
                <label><input type="checkbox" name="condutaAvaliacao" value="Avaliação Motora"> Avaliação Motora</label>
                <label><input type="checkbox" name="condutaAvaliacao" value="Avaliação Admissional"> Avaliação Admissional</label>
            </div>
        </div>
        
        <!-- Gerenciamento -->
        <div class="sub-section">
            <h4>Gerenciamento</h4>
            <div class="checkbox-group">
                <label><input type="checkbox" name="condutaGerenciamento" value="Gerenciamento de VM"> Gerenciamento de VM</label>
                <label><input type="checkbox" name="condutaGerenciamento" value="Gerenciamento da VNI"> Gerenciamento da VNI</label>
                <label><input type="checkbox" name="condutaGerenciamento" value="Gerenciamento de oxigenoterapia"> Gerenciamento de oxigenoterapia</label>
                <label><input type="checkbox" name="condutaGerenciamento" value="Gerenciamento dos Alarmes Ventilatórios"> Gerenciamento dos Alarmes Ventilatórios</label>
                <label><input type="checkbox" name="condutaGerenciamento" value="Gerenciamento da pressão do Cuff"> Gerenciamento da pressão do Cuff</label>
            </div>
        </div>
        
        <!-- Intervenções Respiratórias -->
        <div class="sub-section">
            <h4>Intervenções Respiratórias</h4>
            <div class="checkbox-group">
                <label><input type="checkbox" name="condutaRespiratoria" value="Ajuste de Pcuff"> Ajuste de Pcuff</label>
                <label><input type="checkbox" name="condutaRespiratoria" value="Ajuste de Modo Ventilatório"> Ajuste de Modo Ventilatório</label>
                <label><input type="checkbox" name="condutaRespiratoria" value="Respiração por pressão positiva intermitente - RPPI"> RPPI</label>
                <label><input type="checkbox" name="condutaRespiratoria" value="Cálculo de Volume Minuto Ideal"> Cálculo de Volume Minuto Ideal</label>
                <label><input type="checkbox" name="condutaRespiratoria" value="Terapia de Higiene Brônquica" onclick="mostrarDetalhesSecrecao()"> Terapia de Higiene Brônquica</label>
                <label><input type="checkbox" name="condutaRespiratoria" value="Troca de Filtro" onclick="mostrarDetalhesTroca('filtro')"> Troca de Filtro</label>
<label><input type="checkbox" name="condutaRespiratoria" value="Troca de Trach Care" onclick="mostrarDetalhesTroca('trach')"> Troca de Trach Care</label>
                <label><input type="checkbox" name="condutaRespiratoria" value="Titulação de PEEP"> Titulação de PEEP</label>
            </div>
            
            <div id="detalhesSecrecao" class="sub-section" style="display:none;">
    <label>Quantidade:</label>
    <select id="quantidadeSecrecao">
        <option value="Pouca quantidade">Pouca quantidade</option>
        <option value="Moderada quantidade">Moderada quantidade</option>
        <option value="Grande quantidade">Grande quantidade</option>
    </select>
    
    <label style="margin-top:10px;">Aspecto:</label>
    <select id="aspectoSecrecao">
        <option value="Mucóide">Mucóide</option>
        <option value="Purulenta">Purulenta</option>
        <option value="Sanguinolenta">Sanguinolenta</option>
        <option value="Espessa">Espessa</option>
        <option value="Serosa">Serosa</option>
    </select>
</div>
            <!-- Detalhes para Troca de Filtro -->
<div id="detalhesTrocaFiltro" class="sub-section" style="display:none;">
    <label>Motivo:</label>
    <div class="radio-group">
        <label><input type="radio" name="motivoTrocaFiltro" value="Por sujidade"> Por sujidade</label>
        <label><input type="radio" name="motivoTrocaFiltro" value="Por data"> Por data</label>
    </div>
</div>

<!-- Detalhes para Troca de Trach Care -->
<div id="detalhesTrocaTrach" class="sub-section" style="display:none;">
    <label>Motivo:</label>
    <div class="radio-group">
        <label><input type="radio" name="motivoTrocaTrach" value="Por sujidade"> Por sujidade</label>
        <label><input type="radio" name="motivoTrocaTrach" value="Por data"> Por data</label>
    </div>
</div>
        </div>
        
        <!-- Intervenções Motoras -->
        <div class="sub-section">
            <h4>Intervenções Motoras</h4>
            <div class="checkbox-group">
                <label><input type="checkbox" name="condutaMotora" value="Bombeamento tíbio társico"> Bombeamento tíbio társico</label>        
        <label><input type="checkbox" name="condutaMotora" value="Cicloergometro"> Cicloergometro</label>
        <label><input type="checkbox" name="condutaMotora" value="Descarga de peso"> Descarga de peso</label>
        <label><input type="checkbox" name="condutaMotora" value="Enfaixamento"> Enfaixamento</label>
        <label><input type="checkbox" name="condutaMotora" value="Estímulo à ativação muscular"> Estímulo à ativação muscular</label>
        <label><input type="checkbox" name="condutaMotora" value="Estímulos à linha média"> Estímulos à linha média</label>
        <label><input type="checkbox" name="condutaMotora" value="Estimulação tátil cinestésica"> Estimulação tátil cinestésica</label>
        <label><input type="checkbox" name="condutaMotora" value="Diagonais (PNF)"> Diagonais (PNF)</label>
        <label><input type="checkbox" name="condutaMotora" value="Deambulação"> Deambulação</label>
        <label><input type="checkbox" name="condutaMotora" value="Exercício de Ponte"> Exercício de Ponte</label>
        <label><input type="checkbox" name="condutaMotora" value="Facilitação da marcha"> Facilitação da marcha</label>
        <label><input type="checkbox" name="condutaMotora" value="Fortalecimento Muscular com Caneleira"> Fortalecimento com Caneleira</label>
        <label><input type="checkbox" name="condutaMotora" value="Fortalecimento Muscular com Halter"> Fortalecimento com Halter</label>
        <label><input type="checkbox" name="condutaMotora" value="Mobilização no leito"> Mobilização no leito</label>
        <label><input type="checkbox" name="condutaMotora" value="Ortostase"> Ortostase</label>
        <label><input type="checkbox" name="condutaMotora" value="Prancha Ortostática"> Prancha Ortostática</label>
        <label><input type="checkbox" name="condutaMotora" value="Sedestação com membros pendentes"> Sedestação com membros pendentes</label>
        <label><input type="checkbox" name="condutaMotora" value="Sedestação na poltrona"> Sedestação na poltrona</label>
        <label><input type="checkbox" name="condutaMotora" value="Treino de Sedestação e Ortostase"> Treino de Sedestação/Ortostase</label>
        <label><input type="checkbox" name="condutaMotora" value="Treino de controle de tronco"> Treino de controle de tronco</label>
            </div>
        </div>
        
        <!-- Posicionamento -->
        <div class="sub-section">
            <h4>Posicionamento</h4>
            <div class="checkbox-group">
                <label><input type="checkbox" name="condutaPosicionamento" value="Posicionamento biomecânico adequado"> Posicionamento biomecânico adequado</label>
            </div>
        </div>
        
        <!-- Marcos de Mobilização -->
        <div class="sub-section">
    <label>Marcos de Mobilização:</label>
    <textarea id="marcosMobilizacao" placeholder="Ex: Primeira ortostase (data), Primeira deambulação (data), Progressões..." style="height: 80px;"></textarea>
</div>
    </div>
</div>

        <!-- Seção de códigos de cobrança -->
<div class="expandable-section">
    <div class="section-header"> Códigos de Cobrança</div>
    <div class="section-content">
        <div class="radio-group">
            <label><input type="radio" name="codigosCobranca" value="Sim" onclick="mostrarCodigosCobranca()" checked> Sim</label>
            <label><input type="radio" name="codigosCobranca" value="Não" onclick="esconderCodigosCobranca()"> Não</label>
        </div>
        
        <div id="codigosCobrancaContainer" class="sub-section">
            <p id="codigosText">Códigos: 03.02.04.001-3/ 03.02.05.003-5/ 03.02.06.002-2/ 03.02.04.003-0/ 03.02.04.004-8/ 03.02.05.001-9</p>
        </div>
    </div>
</div>
                
                <div id="codigosCobrancaContainer" class="sub-section" style="display:none;">
                    <p id="codigosText"></p>
                </div>
            </div>
        </div>

        <!-- Botões de ação -->
        <div style="margin: 20px 0;">
            <button onclick="gerarEvolucao()">Gerar Evolução</button>
            <button onclick="gerarMiniEvolucao()">Mini Evolução</button>
            <button onclick="copiarTexto()">Copiar Texto</button>
        </div>

        <!-- Container para mostrar campos não preenchidos -->
        <div id="missingFieldsContainer" style="display: none; background-color: #ffeeee; padding: 15px; border-radius: var(--border-radius); margin-bottom: 20px;">
            <h3 style="color: var(--danger-color); margin-top: 0;">Campos obrigatórios não preenchidos:</h3>
            <ul id="missingFieldsList" style="color: var(--danger-color); padding-left: 20px;"></ul>
        </div>

        <!-- Seção de texto gerado -->
        <div class="output-section">
            <h3>Texto Gerado:</h3>
            <textarea id="textoEvolucao" readonly></textarea>
        </div>
        
        <div class="developer-credit">Desenvolvedor: Daniel Macedo</div>
    </div>

    <script>
        // Funções para expandir/recolher seções
        document.querySelectorAll('.section-header').forEach(header => {
            header.addEventListener('click', () => {
                header.classList.toggle('expanded');
                const content = header.nextElementSibling;
                content.style.display = content.style.display === 'block' ? 'none' : 'block';
            });
        });

// Mostrar trabalho respiratório sempre que qualquer PMV for selecionado
document.querySelectorAll('input[name="pmv"]').forEach(radio => {
    radio.addEventListener('change', function() {
        document.getElementById("trabalhoRespiratorioContainer").style.display = "block";
    });
});

// Garantir que está visível ao carregar a página
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById("trabalhoRespiratorioContainer").style.display = "block";
});

// Mostrar afasia só na UTI Neuro
document.getElementById("uti").addEventListener("change", function() {
    document.getElementById("afasiaContainer").style.display = 
        this.value === "NEURO" ? "block" : "none";
});

        // Funções para mostrar/ocultar opções de contenção
        function mostrarOpcoesContencao() {
            let contencao = document.querySelector('input[name="contencao"]:checked');
            if(contencao) document.getElementById("opcoesContencao").style.display = contencao.value === "Sim" ? "block" : "none";
        }

        function mostrarDrogas() {
            let drogas = document.querySelector('input[name="drogasVasoativas"]:checked');
            if(drogas) document.getElementById("opcoesDrogas").style.display = drogas.value === "com uso de drogas vasoativas" ? "block" : "none";
        }

function mostrarDetalhesTroca(tipo) {
    document.getElementById("detalhesTrocaFiltro").style.display = tipo === 'filtro' ? "block" : "none";
    document.getElementById("detalhesTrocaTrach").style.display = tipo === 'trach' ? "block" : "none";
}

        function mostrarOpcoesSedacao() {
    let sedacao = document.querySelector('input[name="sedacao"]:checked');
    if(sedacao) {
        if (sedacao.value === "Sim") {
            document.getElementById("opcoesSedacao").style.display = "block";
            document.getElementById("opcoesGlasgow").style.display = "none";
        } else if (sedacao.value === "Narcose Anestésica") {
            document.getElementById("opcoesSedacao").style.display = "none";
            document.getElementById("opcoesGlasgow").style.display = "none";
        } else {
            document.getElementById("opcoesSedacao").style.display = "none";
            document.getElementById("opcoesGlasgow").style.display = "block";
// ===== [NOVO CÓDIGO - SAÍDA GLASGOW] =====
let glasgowTotal = document.getElementById("glasgow")?.value || "não avaliado";
let glasgowOcular = document.getElementById("glasgowOcular")?.value || "?";
let glasgowVerbal = document.getElementById("glasgowVerbal")?.value || "?";
let glasgowMotora = document.getElementById("glasgowMotora")?.value || "?";
estadoMentalTexto += `Escala de Glasgow: ${glasgowTotal} (${glasgowOcular}+${glasgowVerbal}+${glasgowMotora})`;
// ===== [FIM DO NOVO CÓDIGO] =====
        }
    }
}

function toggleArticulacoes(checkbox, membro, tipo = 'Paralisia') {
    const id = tipo === 'Paralisia' 
        ? `articulacoes${membro}` 
        : `articulacoesFraqueza${membro}`;
    
    const section = document.getElementById(id);
    
    if (checkbox.checked) {
        section.style.display = 'block';
        // Expande a seção
        section.parentElement.querySelector('.section-header').classList.add('expanded');
    } else {
        section.style.display = 'none';
        // Recolhe a seção
        section.parentElement.querySelector('.section-header').classList.remove('expanded');
        // Desmarca todas as articulações deste membro
        const checkboxes = section.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(cb => cb.checked = false);
    }
}

        function showLungOptions() { document.getElementById("lungOptions").style.display = "block"; }
        function hideLungOptions() { document.getElementById("lungOptions").style.display = "none"; }

        function mostrarOpcoesRuidos() {
            document.getElementById("opcoesRuidos").style.display = "block";
            let ausculta = document.querySelector('input[name="ausculta"]:checked');
            document.getElementById("sonsReduzidosOptions").style.display = ausculta && ausculta.value === "Sons reduzidos" ? "block" : "none";
        }

        function mostrarTiposRuidos() { 
            document.getElementById("tiposRuidos").style.display = "block"; 
            if (document.querySelector('input[name="tipoRuido"][value="Roncos"]:checked')) {
                document.getElementById("sonsReduzidosOptions").style.display = "block";
            }
        }
        function esconderTiposRuidos() { document.getElementById("tiposRuidos").style.display = "none"; }
        function mostrarCamposHGA() { 
            document.getElementById("camposHGA").style.display = "block";
            if (document.getElementById("sistemaRespiratorio").value === "vni") {
                document.getElementById("hacorContainer").style.display = "block";
                calcularHACOR();
            }
        }
        function esconderCamposHGA() { 
            document.getElementById("camposHGA").style.display = "none";
            document.getElementById("hacorContainer").style.display = "none";
        }
        
        // Funções modificadas para TQT e TOT
        function mostrarOpcoesTQT() {
            document.getElementById("opcoesTQT").style.display = "block";
            document.getElementById("cuffOptions").style.display = "none";
        }

        function mostrarCuffOptions() {
            document.getElementById("opcoesTQT").style.display = "none";
            document.getElementById("cuffOptions").style.display = "block";
        }
        
        function mostrarPressaoCuff() { document.getElementById("pressaoCuff").style.display = "block"; }
        function esconderPressaoCuff() { document.getElementById("pressaoCuff").style.display = "none"; }

        function mostrarOpcoesMRC() {
            document.getElementById("opcoesMRC").style.display = "block";
            document.getElementById("motivosNaoAvaliar").style.display = "none";
        }

        function mostrarMotivosNaoAvaliar() {
            document.getElementById("opcoesMRC").style.display = "none";
            document.getElementById("motivosNaoAvaliar").style.display = "block";
        }

        function atualizarInterpretacaoMRC(total) {
            let interpretation = "";
            if (total === 0) interpretation = "Paralisia total";
            else if (total >= 1 && total <= 24) interpretation = "Fraqueza muscular severa";
            else if (total >= 25 && total <= 47) interpretation = "Fraqueza muscular moderada";
            else if (total >= 48) interpretation = "Força muscular preservada";
            document.getElementById("mrcInterpretation").textContent = interpretation;
        }

        function mostrarLocalizacaoADM() { document.getElementById("localizacaoADM").style.display = "block"; }
        function esconderLocalizacaoADM() { document.getElementById("localizacaoADM").style.display = "none"; }

        function atualizarOpcoesRespiratorias() {
            let tipo = document.getElementById("sistemaRespiratorio").value;
            let div = document.getElementById("opcoesRespiratorias");
            let html = "";
            
            // Esconde todos os parâmetros de ventilação inicialmente
            document.getElementById("ventilationParams").style.display = "none";
            document.getElementById("viaAereaOptions").style.display = "none";
            document.getElementById("fluxoContainer").style.display = "none";
            document.getElementById("fio2CNAFContainer").style.display = "none";
            document.getElementById("roxContainer").style.display = "none";

            if (tipo === "espontanea") {
    html = `
        <div class="sub-section">
            <label>Via Aérea: </label>
            <div class="radio-group">
                <label><input type="radio" name="tipoEspontanea" value="Via aérea Fisiológica" checked> Via aérea Fisiológica</label>
                <label><input type="radio" name="tipoEspontanea" value="Via TQT">Via TQT</label>
            </div>
        </div>
        
        <div class="sub-section">
            <label>Suporte de Oxigênio:</label>
            <div class="radio-group">
                <label><input type="radio" name="opcaoEspontanea" value="Ar ambiente " onclick="hideFluxoField(); hideMaskOptions(); esconderFiO2CNAF(); esconderROX()" checked> Ar ambiente </label>
                <label><input type="radio" name="opcaoEspontanea" value="Cateter O2" onclick="showFluxoField(); hideMaskOptions(); esconderFiO2CNAF(); esconderROX()"> Cateter O2</label>
                <label><input type="radio" name="opcaoEspontanea" value="Máscara O2" onclick="showMaskOptions(); esconderFiO2CNAF(); esconderROX()"> Máscara O2</label>
                <label><input type="radio" name="opcaoEspontanea" value="CNAF" onclick="showFluxoField(); hideMaskOptions(); mostrarFiO2CNAF(); mostrarROX()"> CNAF</label>
            </div>
            
            <div id="maskOptions" class="sub-section" style="display:none;">
                <label>Tipo de Máscara:</label>
                <div class="radio-group">
                    <label><input type="radio" name="maskType" value="Máscara simples" onclick="showFluxoField(); esconderFiO2CNAF(); esconderROX()" checked> Máscara simples</label>
                    <label><input type="radio" name="maskType" value="Máscara de Venturi" onclick="showFluxoField(); esconderFiO2CNAF(); esconderROX()"> Máscara de Venturi</label>
                    <label><input type="radio" name="maskType" value="Máscara não reinalante" onclick="showFluxoField(); esconderFiO2CNAF(); esconderROX()"> Máscara não reinalante</label>
                </div>
            </div>
        </div>`;
} else if (tipo === "vni") {
                html = `
                    <div class="sub-section">
                        <label>Modo:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="modoVNI" value="CPAP" checked> CPAP</label>
                            <label><input type="radio" name="modoVNI" value="BIPAP"> BIPAP</label>
                        </div>
                        
                        <div class="sub-section">
                            <label>Tipo de Máquina:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tipoMaquinaVNI" value="Gerador de Fluxo" checked> Gerador de Fluxo</label>
                                <label><input type="radio" name="tipoMaquinaVNI" value="Ventilador Mecânico"> Ventilador Mecânico</label>
                            </div>
                        </div>
                        
                        <div class="sub-section">
                            <label>Parâmetros:</label>
                            <div class="vital-signs-container">
                                <div class="vital-sign">
                                    <label>EPAP (cmH2O):</label>
                                    <input type="number" id="epap" min="0" step="0.1" oninput="calcularHACOR()">
                                </div>
                                <div class="vital-sign">
                                    <label>IPAP (cmH2O):</label>
                                    <input type="number" id="ipap" min="0" step="0.1" oninput="calcularHACOR()">
                                </div>
                                <div class="vital-sign">
                                    <label>FiO2 (%):</label>
                                    <input type="number" id="fio2VNI" min="21" max="100" oninput="calcularHACOR()">
                                </div>
                            </div>
                        </div>
                        
                        <div id="hacorContainer" class="sub-section" style="display:none;">
                            <h4>Índice HACOR</h4>
                            <p>Pontuação: <span id="hacorScore">-</span> (<span id="hacorInterpretation">-</span>)</p>
                        </div>
                    </div>`;
            } else if (tipo === "VM") {
                document.getElementById("viaAereaOptions").style.display = "block";
                html = `
                    <div class="sub-section">
                        <label>Modo:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="modoVM" value="VCV" onclick="mostrarParametrosVentilacao('VCV')"> VCV (Volume Controlado)</label>
                            <label><input type="radio" name="modoVM" value="PCV" onclick="mostrarParametrosVentilacao('PCV')"> PCV (Pressão Controlada)</label>
                            <label><input type="radio" name="modoVM" value="PSV" onclick="mostrarParametrosVentilacao('PSV')"> PSV (Pressão de Suporte)</label>
                            <label><input type="radio" name="modoVM" value="SIMV" onclick="mostrarParametrosVentilacao('SIMV')"> SIMV (Ventilação Mandatória Intermitente Sincronizada)</label>
                        </div>
                    </div>`;
            }

            div.innerHTML = html;
        }

        function mostrarParametrosVentilacao(modo) {
            document.getElementById('VCVParams').style.display = 'none';
            document.getElementById('PCVParams').style.display = 'none';
            document.getElementById('PSVParams').style.display = 'none';
            document.getElementById('SIMVParams').style.display = 'none';
            
            if (modo === 'VCV') document.getElementById('VCVParams').style.display = 'block';
            else if (modo === 'PCV') document.getElementById('PCVParams').style.display = 'block';
            else if (modo === 'PSV') document.getElementById('PSVParams').style.display = 'block';
            else if (modo === 'SIMV') document.getElementById('SIMVParams').style.display = 'block';
            
            document.getElementById('ventilationParams').style.display = 'block';
        }

        function showFluxoField() { document.getElementById("fluxoContainer").style.display = "block"; }
        function hideFluxoField() { document.getElementById("fluxoContainer").style.display = "none"; }
        function showMaskOptions() { document.getElementById("maskOptions").style.display = "block"; document.getElementById("fluxoContainer").style.display = "block"; }
        function hideMaskOptions() { const maskOptions = document.getElementById("maskOptions"); if (maskOptions) maskOptions.style.display = "none"; }
        
        function mostrarFiO2CNAF() {
            document.getElementById("fio2CNAFContainer").style.display = "block";
        }

        function esconderFiO2CNAF() {
            document.getElementById("fio2CNAFContainer").style.display = "none";
        }

        function mostrarROX() {
            document.getElementById("roxContainer").style.display = "block";
            calcularROX();
        }

        function esconderROX() {
            document.getElementById("roxContainer").style.display = "none";
        }

        // Função para mostrar detalhes da secreção
        function mostrarDetalhesSecrecao() {
    const checkbox = document.querySelector('input[name="condutaRespiratoria"][value="Terapia de Higiene Brônquica"]');
    document.getElementById("detalhesSecrecao").style.display = checkbox.checked ? "block" : "none";
    
    // Garante que outros detalhes sejam ocultados
    document.getElementById("detalhesTrocaFiltro").style.display = "none";
    document.getElementById("detalhesTrocaTrach").style.display = "none";
}

        // Função para mostrar detalhes da troca de filtro/trach care
        function mostrarDetalhesTroca(tipo) {
            const checkbox = document.querySelector(`input[name="condutaRespiratoria"][value="Troca de ${tipo === 'filtro' ? 'Filtro' : 'Trach Care'}"]`);
            document.getElementById(`detalhesTroca${tipo === 'filtro' ? 'Filtro' : 'Trach'}`).style.display = checkbox.checked ? "block" : "none";
        }

        // Função para calcular o índice HACOR
      function calcularHACOR() {
    // Obter valores necessários
    const fc = parseInt(document.getElementById("fc").value) || 0;
    const ph = parseFloat(document.getElementById("ph").value) || 7.4;
    const glasgow = parseInt(document.getElementById("glasgow").value) || 15;
    const pao2 = parseFloat(document.getElementById("pao2").value) || 0;
    const fio2VNI = parseFloat(document.getElementById("fio2VNI").value) || 21;
    const fr = parseInt(document.getElementById("fr").value) || 0;

    // Calcular PaO2/FiO2 (se PaO2 disponível)
    const pf = pao2 > 0 ? pao2 / (fio2VNI / 100) : 0;

    // Pontuação HACOR (inicializa com 0)
    let score = 0;

    // 1. Frequência Cardíaca (FC)
    if (fc > 120) score += 1;  // >120 = +1 ponto | <=120 = 0 pontos

    // 2. Acidose (pH)
    if (ph < 7.25) score += 4;          // <7.25 = +4
    else if (ph < 7.30) score += 3;     // 7.25-7.29 = +3
    else if (ph < 7.35) score += 2;     // 7.30-7.34 = +2
    // >=7.35 = 0 pontos

    // 3. Consciência (GCS)
    if (glasgow <= 10) score += 10;     // ≤10 = +10
    else if (glasgow <= 12) score += 5; // 11-12 = +5
    else if (glasgow <= 14) score += 2; // 13-14 = +2
    // 15 = 0 pontos

    // 4. Oxigenação (PaO2/FiO2)
    if (pf > 0) {
        if (pf <= 100) score += 6;        // ≤100 = +6
        else if (pf <= 125) score += 5;   // 101-125 = +5
        else if (pf <= 150) score += 4;   // 126-150 = +4
        else if (pf <= 175) score += 3;   // 151-175 = +3
        else if (pf <= 200) score += 2;   // 176-200 = +2
        // >200 = 0 pontos
    }

    // 5. Frequência Respiratória (FR)
    if (fr >= 46) score += 4;           // ≥46 = +4
    else if (fr >= 41) score += 3;      // 41-45 = +3
    else if (fr >= 36) score += 2;      // 36-40 = +2
    else if (fr >= 31) score += 1;      // 31-35 = +1
    // <=30 = 0 pontos

    // Interpretação
    let interpretation = "";
    if (score >= 5) interpretation = "Alto risco de falha da VNI (considerar intubação)";
    else interpretation = "Baixo risco de falha da VNI";

    // Atualizar interface
    const hacorContainer = document.getElementById("hacorContainer");
    if (hacorContainer) {
        hacorContainer.style.display = "block";
        document.getElementById("hacorScore").textContent = score;
        document.getElementById("hacorInterpretation").textContent = interpretation;
    }
}

        function calcularROX() {
            const spo2 = parseFloat(document.getElementById("spo2").value) || 0;
            const fr = parseFloat(document.getElementById("fr").value) || 0;
            const fio2Input = parseFloat(document.getElementById("fio2CNAF").value) || 21;
            
            // FiO2 já está em porcentagem (ex: 50 para 50%)
            // Não precisa converter para decimal como fiz anteriormente
            if (spo2 > 0 && fr > 0 && fio2Input > 0) {
                // Fórmula: ROX = (SpO2 / FiO2) * 100 / FR
                const rox = (spo2 / fio2Input) * 100 / fr;
                const roxValue = rox.toFixed(2);
                document.getElementById("roxValue").textContent = roxValue;
                
                // Interpretação do ROX (valores de referência)
                let interpretation = "";
                if (rox >= 4.88) interpretation = "(Baixo risco de falha)";
                else if (rox >= 3.85) interpretation = "(Risco intermediário)";
                else interpretation = "(Alto risco de falha)";
                
                document.getElementById("roxInterpretation").textContent = interpretation;
            } else {
                document.getElementById("roxValue").textContent = "-";
                document.getElementById("roxInterpretation").textContent = "";
            }
        }

        // Funções para déficit motor
        function mostrarOpcoesDeficitMotor() {
            document.getElementById("opcoesDeficitMotor").style.display = "block";
        }

        function esconderOpcoesDeficitMotor() {
            document.getElementById("opcoesDeficitMotor").style.display = "none";
            document.getElementById("localizacaoParalisia").style.display = "none";
            document.getElementById("localizacaoFraqueza").style.display = "none";
        }

        function mostrarLocalizacaoParalisia() {
            document.getElementById("localizacaoParalisia").style.display = "block";
            document.getElementById("localizacaoFraqueza").style.display = "none";
        }

        function mostrarLocalizacaoFraqueza() {
            document.getElementById("localizacaoFraqueza").style.display = "block";
            document.getElementById("localizacaoParalisia").style.display = "none";
        }

        // Funções para déficit sensorial
        function mostrarOpcoesDeficitSensorial() {
            document.getElementById("opcoesDeficitSensorial").style.display = "block";
        }

        function esconderOpcoesDeficitSensorial() {
            document.getElementById("opcoesDeficitSensorial").style.display = "none";
            document.getElementById("localizacaoPropriocepcao").style.display = "none";
            document.getElementById("localizacaoCinetesia").style.display = "none";
            document.getElementById("localizacaoBarognosia").style.display = "none";
        }

        function mostrarLocalizacaoPropriocepcao() {
            const checkbox = document.querySelector('input[name="deficitSensorialTipo"][value="Propriocepção alterada"]');
            document.getElementById("localizacaoPropriocepcao").style.display = checkbox.checked ? "block" : "none";
        }

        function mostrarLocalizacaoCinetesia() {
            const checkbox = document.querySelector('input[name="deficitSensorialTipo"][value="Cinetesia prejudicada"]');
            document.getElementById("localizacaoCinetesia").style.display = checkbox.checked ? "block" : "none";
        }

        function mostrarLocalizacaoBarognosia() {
            const checkbox = document.querySelector('input[name="deficitSensorialTipo"][value="Barognosia alterada"]');
            document.getElementById("localizacaoBarognosia").style.display = checkbox.checked ? "block" : "none";
        }

        // Funções para capacidade funcional
        function mostrarEscalaFSS() {
            document.getElementById("opcoesFSS").style.display = "block";
            document.getElementById("motivosNaoAplicarFSS").style.display = "none";
            atualizarInterpretacaoFSS(document.getElementById("fssScore").value);
        }

        function mostrarMotivosNaoAplicarFSS() {
            document.getElementById("opcoesFSS").style.display = "none";
            document.getElementById("motivosNaoAplicarFSS").style.display = "block";
            document.getElementById("fssInterpretation").textContent = "";
        }

        function atualizarInterpretacaoFSS(score) {
            let interpretation = "";
            if (score >= 0 && score <= 10) interpretation = "Dependência total";
            else if (score >= 11 && score <= 20) interpretation = "Dependência moderada";
            else if (score >= 21 && score <= 30) interpretation = "Dependência leve";
            else if (score >= 31) interpretation = "Independente";
            document.getElementById("fssInterpretation").textContent = interpretation;
        }

        // Funções para tosse
        function mostrarTipoTosse() {
            document.getElementById("tipoTosse").style.display = "block";
        }

        function esconderTipoTosse() {
            document.getElementById("tipoTosse").style.display = "none";
        }

        // Função para verificar campos não preenchidos
        function verificarCamposNaoPreenchidos() {
            const missingFields = [];
            
            // Agrupar campos por sistemas/categorias
            const categorias = {
                "Dados básicos": [
                    {id: "uti", nome: "UTI"},
                    {id: "dataEvolucao", nome: "Data da Evolução"},
                    {id: "turno", nome: "Turno"}
                ],
                "Admissão": [
                    {cond: () => document.getElementById("tipoDocumento").value === "admissao", 
                     id: "hdaTexto", nome: "HDA (História da Doença Atual)"}
                ],
                "Encontrado no Leito": [
                    {id: "posicaoLeito", nome: "Posição no leito"}
                ],
                "Sinais vitais": [
                    {id: "fc", nome: "Frequência Cardíaca (FC)"},
                    {id: "fr", nome: "Frequência Respiratória (FR)"},
                    {id: "spo2", nome: "SpO2"},
                    {id: "pa", nome: "Pressão Arterial (PA)"},
                    {id: "temp", nome: "Temperatura"}
                ],
                "Sistema respiratório": [
                    {id: "sistemaRespiratorio", nome: "Tipo de ventilação"},
                    {cond: () => document.getElementById("sistemaRespiratorio").value === "espontanea" && 
                                 document.querySelector('input[name="opcaoEspontanea"]:checked')?.value === "CNAF" && 
                                 !document.getElementById("fluxo").value, 
                     nome: "Fluxo de O2"},
                    {cond: () => document.getElementById("sistemaRespiratorio").value === "vni", 
                     checks: [
                         {id: "epap", nome: "EPAP"},
                         {id: "ipap", nome: "IPAP"},
                         {id: "fio2VNI", nome: "FiO2 VNI"}
                     ]},
                    {cond: () => document.getElementById("sistemaRespiratorio").value === "VM", 
                     checks: [
                         {cond: () => document.querySelector('input[name="modoVM"]:checked')?.value === "VCV" && 
                                      !document.getElementById("vc").value, 
                          nome: "Volume Corrente (VC)"},
                         {cond: () => document.querySelector('input[name="modoVM"]:checked')?.value === "PCV" && 
                                      !document.getElementById("pinsp").value, 
                          nome: "Pressão Inspiratória (Pinsp)"},
                         {cond: () => document.querySelector('input[name="modoVM"]:checked')?.value === "PSV" && 
                                      !document.getElementById("psup").value, 
                          nome: "Pressão de Suporte (Psup)"}
                     ]}
                ],
                "Ausculta pulmonar": [
                    {cond: () => !document.querySelector('input[name="ausculta"]:checked'), 
                     nome: "Ausculta pulmonar"}
                ],
                "Hemogasometria": [
                    {cond: () => document.querySelector('input[name="hga"]:checked')?.value === "Com HGA", 
                     checks: [
                         {id: "ph", nome: "pH"},
                         {id: "pao2", nome: "PaO2"},
                         {id: "pco2", nome: "PCO2"},
                         {id: "hco3", nome: "HCO3"}
                     ]}
                ],
                "Capacidade funcional": [
                    {cond: () => document.querySelector('input[name="escalaFSS"]:checked')?.value === "Aplicavel" && 
                                 !document.getElementById("fssScore").value, 
                     nome: "Escala FSS"}
                ]
            };

            // Verificar cada categoria
            Object.entries(categorias).forEach(([categoria, campos]) => {
                let camposFaltantes = [];
                
                campos.forEach(campo => {
                    if (campo.cond && !campo.cond()) return;
                    
                    if (campo.id) {
                        if (!document.getElementById(campo.id).value) {
                            camposFaltantes.push(campo.nome);
                        }
                    } 
                    else if (campo.checks) {
                        campo.checks.forEach(subcampo => {
                            if (subcampo.cond && !subcampo.cond()) return;
                            if (!document.getElementById(subcampo.id)?.value) {
                                camposFaltantes.push(subcampo.nome);
                            }
                        });
                    }
                });
                
                if (camposFaltantes.length > 0) {
                    missingFields.push(`<strong>${categoria}:</strong> ${camposFaltantes.join(", ")}`);
                }
            });

            // Atualizar a exibição dos campos não preenchidos
            const missingFieldsContainer = document.getElementById("missingFieldsContainer");
            const missingFieldsList = document.getElementById("missingFieldsList");
            
            if (missingFields.length > 0) {
                missingFieldsList.innerHTML = "";
                missingFields.forEach(field => {
                    const li = document.createElement("li");
                    li.innerHTML = field;
                    missingFieldsList.appendChild(li);
                });
                missingFieldsContainer.style.display = "block";
            } else {
                missingFieldsContainer.style.display = "none";
            }
            
            return missingFields;
        }

        function validarEvolucao() {
            gerarEvolucao();
        }

        function gerarEvolucao() {

const ordemCondutas = [
    "Estímulo à ativação muscular", "Mobilização no leito", "Enfaixamento",
    "Bombeamento tíbio társico", "Cicloergometro", "Exercício de Ponte",
    "Sedestação com membros pendentes", "Sedestação na poltrona", "Descarga de peso",
    "Estímulos à linha média", "Estimulação tátil cinestésica", "Diagonais (PNF)",
    "Treino de controle de tronco", "Fortalecimento Muscular com Caneleira",
    "Fortalecimento Muscular com Halter", "Ortostase", "Treino de Sedestação e Ortostase",
    "Facilitação da marcha", "Deambulação", "Prancha Ortostática"
];   

 // Primeiro verifica os campos não preenchidos
    verificarCamposNaoPreenchidos();
    
    let evolucao = "";
    
    // Cabeçalho - modificado para considerar o tipo de documento
    let tipoDocumento = document.getElementById("tipoDocumento").value;
    let sexo = document.querySelector('input[name="sexo"]:checked')?.value || "não avaliado";
    let uti = document.getElementById("uti").value || "não avaliado";
    let data = document.getElementById("dataEvolucao").value || "não avaliado";
    let turno = document.getElementById("turno").value || "não avaliado";
    
    if (tipoDocumento === "evolucao") {
        evolucao = `EVOLUÇÃO FISIOTERAPIA UTI ${uti} - ${data} - ${turno.toUpperCase()}\n\n`;
    } else {
        evolucao = `ADMISSÃO FISIOTERAPIA UTI ${uti} - ${data} - ${turno.toUpperCase()}\n\n`;
        
        // Inclui o HDA se for Admissão
        let hda = document.getElementById("hdaTexto")?.value.trim();
        if (hda) {
            evolucao += `HDA: ${hda}\n\n`;
        }
    }

    // Posição e contenção
    let posicao = document.getElementById("posicaoLeito")?.value || "não avaliado";
    let contencao = document.querySelector('input[name="contencao"]:checked');
    let contencaoTexto = contencao ? (contencao.value === "Sim" ? "com contenção" : "sem contenção") : "não avaliado";
    let membrosContidos = "";
    if (contencao && contencao.value === "Sim") {
        let MMSS = document.querySelector('input[name="MMSS"]:checked') ? "MMSS" : "";
        let MMII = document.querySelector('input[name="MMII"]:checked') ? "MMII" : "";
        membrosContidos = (MMSS && MMII) ? `${MMSS} e ${MMII}` : (MMSS || MMII);
    }
    evolucao += `Paciente encontrado em ${posicao}, ${contencaoTexto}${membrosContidos ? `, membros contidos ${membrosContidos}` : ''}. `;

    // Avaliação de dor
    let avaliacaoDor = document.querySelector('input[name="avaliacaoDor"]:checked');
if (avaliacaoDor && avaliacaoDor.value === "Sim") {
    let evaValue = document.getElementById("evaValue")?.textContent || "não avaliado";
    evolucao += `Avaliação de dor: presente (EVA: ${evaValue}/10). `;
}
// Remove a linha que mostra "Avaliação de dor: ausente" quando selecionado "Não"

    // Estado mental - ajustado para gênero
    let estados = document.querySelectorAll('input[name="estadoComportamental"]:checked');
            let estadoComportamental = estados.length > 0 
                ? Array.from(estados).map(el => {
                    // Ajusta o gênero dos termos conforme necessário
                    if (sexo === "Feminino") {
                        if (el.value === "desperto") return "desperta";
                        if (el.value === "sonolento") return "sonolenta";
                        if (el.value === "comatoso") return "comatosa";
                        if (el.value === "agitado") return "agitada";
                        if (el.value === "orientado") return "orientada";
                        if (el.value === "confuso") return "confusa";
                        if (el.value === "responsivo") return "responsiva";
                        if (el.value === "não Responsivo") return "não Responsiva";
                        if (el.value === "hipoativo") return "hipoativa";
                    }
                    return el.value.toLowerCase();
                }).join(", ") 
                : "não avaliado";
            
            let estadoMentalTexto = "";
            
            // Adiciona afasia se for UTI Neuro e estiver selecionada
            if (document.getElementById("uti").value === "NEURO") {
                const afasia = document.querySelector('input[name="afasia"]:checked');
                if (afasia && afasia.value !== "Sem") {
                    estadoMentalTexto += `Afasia: ${afasia.value.toLowerCase()}, `;
                }
            }

            let sedacao = document.querySelector('input[name="sedacao"]:checked');
if (sedacao) {
    if (sedacao.value === "Sim") {
        let sedativos = Array.from(document.querySelectorAll('input[name="sedativos"]:checked')).map(el => el.value);
        let rass = document.getElementById("rass")?.value || "não avaliado";
        estadoMentalTexto += `com Sedação ${sedativos.length > 0 ? '(Sedativos: ' + sedativos.join(" e ") + ')' : ''}`;
        if (rass) estadoMentalTexto += `, Escala RASS: ${rass}`;
    } else if (sedacao.value === "Narcose Anestésica") {
    estadoMentalTexto += `em Narcose Anestésica`;
} else { // Adicione este bloco para pacientes não sedados
    let glasgowTotal = document.getElementById("glasgow").value || "não avaliado";
    let glasgowOcular = document.getElementById("glasgowOcular").value || "?";
    let glasgowVerbal = document.getElementById("glasgowVerbal").value || "?";
    let glasgowMotora = document.getElementById("glasgowMotora").value || "?";
    estadoMentalTexto += `Escala de Glasgow: ${glasgowTotal} (${glasgowOcular}+${glasgowVerbal}+${glasgowMotora})`;
}
}
            evolucao += `Estado comportamental: ${estadoComportamental}, ${estadoMentalTexto}, `;

    // Sinais vitais e estado hemodinâmico no mesmo parágrafo
let fc = document.getElementById("fc")?.value || "não avaliado";
let fr = document.getElementById("fr")?.value || "não avaliado";
let spo2 = document.getElementById("spo2")?.value || "não avaliado";
let pa = document.getElementById("pa")?.value || "não avaliado";
let pam = document.getElementById("pam")?.textContent || "";
let paCompleta = pam ? `${pa} ${pam}` : pa;
let temp = document.getElementById("temp")?.value || "não avaliado";

// Estado Hemodinâmico
let hemodinamica = document.querySelector('input[name="hemodinamica"]:checked');
let hemodinamicaTexto = hemodinamica ? hemodinamica.value.toLowerCase() : "não avaliado";

let drogasVasoativas = document.querySelector('input[name="drogasVasoativas"]:checked');
if (drogasVasoativas && drogasVasoativas.value === "com uso de drogas vasoativas") {
    let drogas = Array.from(document.querySelectorAll('input[name="drogas"]:checked')).map(el => el.value);
    if (drogas.length > 0) {
        hemodinamicaTexto += ` com uso de ${drogas.join(", ")}`;
    } else {
        hemodinamicaTexto += ` (drogas não especificadas)`;
    }
} else if (drogasVasoativas && drogasVasoativas.value === "sem uso de drogas vasoativas") {
    hemodinamicaTexto += ` sem drogas vasoativas`;
}

evolucao += `Sinais vitais: FC: ${fc}bpm, FR: ${fr}irpm, SpO₂: ${spo2}%, PA: ${paCompleta}mmHg, Temp: ${temp}°C. Estado hemodinâmico: ${hemodinamicaTexto}.\n\n`;

    // Sistema respiratório
    evolucao += `Sistema respiratório: `;
    let respiratorio = document.getElementById("sistemaRespiratorio")?.value;
    
    if (respiratorio === "vni") {
        let modoVNI = document.querySelector('input[name="modoVNI"]:checked');
        let tipoMaquina = document.querySelector('input[name="tipoMaquinaVNI"]:checked');
        let epap = document.getElementById("epap")?.value || "não avaliado";
        let ipap = document.getElementById("ipap")?.value || "não avaliado";
        let fio2VNI = document.getElementById("fio2VNI")?.value || "não avaliado";
        let hacorScore = document.getElementById("hacorScore")?.textContent;
        let hacorInterpretation = document.getElementById("hacorInterpretation")?.textContent;
        
        evolucao += `Em ventilação não invasiva (VNI) (modo ${modoVNI ? modoVNI.value.toLowerCase() : 'não avaliado'}) via ${tipoMaquina ? tipoMaquina.value.toLowerCase() : 'não avaliado'} `;
        evolucao += `(IPAP: ${ipap}cmH2O, EPAP: ${epap}cmH2O, FiO2: ${fio2VNI}%)`;
        
        if (hacorScore !== "-") {
            evolucao += `, índice HACOR: ${hacorScore} (${hacorInterpretation.toLowerCase()})`;
        }
    } else if (respiratorio === "espontanea") {
        let tipoEspontanea = document.querySelector('input[name="tipoEspontanea"]:checked');
        let tipoEspontaneaTexto = tipoEspontanea ? tipoEspontanea.value.toLowerCase() : "não avaliado";
        
        let opcaoEspontanea = document.querySelector('input[name="opcaoEspontanea"]:checked');
        if (opcaoEspontanea) {
            if (opcaoEspontanea.value === "Máscara O2") {
                let maskType = document.querySelector('input[name="maskType"]:checked');
                let fluxo = document.getElementById("fluxo")?.value || "não avaliado";
                evolucao += `Ventilação espontânea ${tipoEspontaneaTexto} em ${maskType ? maskType.value.toLowerCase() : 'máscara de oxigênio'} (Fluxo: ${fluxo}L/min)`;
            } else if (opcaoEspontanea.value === "CNAF") {
                let fluxo = document.getElementById("fluxo")?.value || "não avaliado";
                let fio2 = document.getElementById("fio2CNAF")?.value || "não avaliado";
                evolucao += `Ventilação espontânea ${tipoEspontaneaTexto} em CNAF (Fluxo: ${fluxo}L/min, FiO₂: ${fio2}%)`;
                
                let roxValue = document.getElementById("roxValue")?.textContent;
                let roxInterpretation = document.getElementById("roxInterpretation")?.textContent;
                if (roxValue && roxValue !== "-") {
                    evolucao += `, índice ROX: ${roxValue} ${roxInterpretation.toLowerCase()}`;
                }
            } else if (opcaoEspontanea.value === "Cateter O2") {
                let fluxo = document.getElementById("fluxo")?.value || "não avaliado";
                evolucao += `Ventilação espontânea ${tipoEspontaneaTexto} em cateter nasal de oxigênio (Fluxo: ${fluxo}L/min)`;
            } else {
                evolucao += `Ventilação espontânea ${tipoEspontaneaTexto} em ${opcaoEspontanea.value.toLowerCase()}`;
            }
        }
    } else if (respiratorio === "VM") {
        let modoVM = document.querySelector('input[name="modoVM"]:checked');
        if(modoVM) {
            evolucao += `Ventilação mecânica (VM) (modo ${modoVM.value.toLowerCase()})`;
            
            if (modoVM.value === "VCV") {
                let vc = document.getElementById("vc")?.value || "não avaliado";
                let peep = document.getElementById("peep")?.value || "não avaliado";
                let fio2 = document.getElementById("fio2")?.value || "não avaliado";
                let frVent = document.getElementById("frVent")?.value || "não avaliado";
                evolucao += ` (VC: ${vc}ml, PEEP: ${peep}cmH2O, FiO2: ${fio2}%, FR: ${frVent}ipm)`;
            } else if (modoVM.value === "PCV") {
                let pinsp = document.getElementById("pinsp")?.value || "não avaliado";
                let peep = document.getElementById("peepPcv")?.value || "não avaliado";
                let fio2 = document.getElementById("fio2Pcv")?.value || "não avaliado";
                let frVent = document.getElementById("frPcv")?.value || "não avaliado";
                evolucao += ` (Pinsp: ${pinsp}cmH2O, PEEP: ${peep}cmH2O, FiO2: ${fio2}%, FR: ${frVent}ipm)`;
            } else if (modoVM.value === "PSV") {
                let psup = document.getElementById("psup")?.value || "não avaliado";
                let peep = document.getElementById("peepPsv")?.value || "não avaliado";
                let fio2 = document.getElementById("fio2Psv")?.value || "não avaliado";
                evolucao += ` (Psup: ${psup}cmH2O, PEEP: ${peep}cmH2O, FiO2: ${fio2}%)`;
            } else if (modoVM.value === "SIMV") {
                let vc = document.getElementById("vcSimv")?.value || "não avaliado";
                let psup = document.getElementById("psupSimv")?.value || "não avaliado";
                let peep = document.getElementById("peepSimv")?.value || "não avaliado";
                let frVent = document.getElementById("frSimv")?.value || "não avaliado";
                let fio2 = document.getElementById("fio2Simv")?.value || "não avaliado";
                evolucao += ` (VC: ${vc}ml, Psup: ${psup}cmH2O, PEEP: ${peep}cmH2O, FR: ${frVent}ipm, FiO2: ${fio2}%)`;
            }
            
            let viaAerea = document.querySelector('input[name="viaAerea"]:checked');
            if (viaAerea) {
                evolucao += `, via aérea: ${viaAerea.value === "TOT" ? "TOT" : "TQT"}`;
                
                if (viaAerea.value === "TQT") {
                    let tipoTQT = document.querySelector('input[name="tipoTQT"]:checked');
                    if (tipoTQT) evolucao += ` (${tipoTQT.value.toLowerCase()})`;
                }
                
                if (viaAerea.value === "TOT") {
    let cuff = document.querySelector('input[name="cuff"]:checked');
    if (cuff) {
        evolucao += `, cuff: ${cuff.value.toLowerCase()}`;
        
        if (cuff.value === "Insuflado") {
            let pcuff = document.getElementById("pcuff")?.value || "não avaliado";
            evolucao += ` (P.Cuff: ${pcuff}cmH2O`;
            
            
            
            // Novos campos
            let rimaLabial = document.getElementById("rimaLabial")?.value;
            let numeroTubo = document.getElementById("numeroTubo")?.value;
            if (rimaLabial) evolucao += `, fixado em ${rimaLabial}cm`;
            if (numeroTubo) evolucao += `, tubo nº ${numeroTubo}`;
            
            evolucao += `)`;
        }
    }
}

// Mecânica Pulmonar
const mecanicaPulmonar = document.querySelector('input[name="mecanicaPulmonar"]:checked');
if (mecanicaPulmonar && mecanicaPulmonar.value === "Sim") {
    const Complacência = document.getElementById("Complacência")?.value;
    const resistencia = document.getElementById("resistencia")?.value;
    const pressaoPlato = document.getElementById("pressaoPlato")?.value;
    const pressaoPico = document.getElementById("pressaoPico")?.value;
    const autoPEEP = document.getElementById("autoPEEP")?.value;
    
    if (Complacência || resistencia || pressaoPlato || pressaoPico || autoPEEP) {
        evolucao += ` Mecânica pulmonar: `;
        if (Complacência) evolucao += `Complacência: ${Complacência}ml/cmH2O, `;
        if (resistencia) evolucao += `Resistência: ${resistencia}cmH2O/L/s, `;
        if (pressaoPlato) evolucao += `P.platô: ${pressaoPlato}cmH2O, `;
        if (pressaoPico) evolucao += `P.pico: ${pressaoPico}cmH2O, `;
        if (autoPEEP) evolucao += `Auto-PEEP: ${autoPEEP}cmH2O`;
        const drivePressure = document.getElementById("drivePressure")?.value;
if (drivePressure) evolucao += `, Drive Pressure: ${drivePressure}cmH2O`;
        
        // Garante que termina com ponto final
        evolucao = evolucao.trim();
        if (!evolucao.endsWith('. ')) {
            evolucao += '. ';
        }
    }
}

            }
        }
    }
    
    // Tosse
    let tosse = document.querySelector('input[name="tosse"]:checked');
    if (tosse) {
        let tosseTexto = tosse.value.toLowerCase();
        
        if (tosse.value === "Eficaz" || tosse.value === "Débil") {
            let tipoTosse = document.querySelector('input[name="tipoTosse"]:checked');
            if (tipoTosse) {
                tosseTexto += ` (${tipoTosse.value.toLowerCase()})`;
            }
        }
        
        evolucao += `Tosse: ${tosseTexto}. `;
    }
    
    // Padrão respiratório e ausculta
let padraoResp = document.querySelector('input[name="respPattern"]:checked');
let padraoRespiratorio = padraoResp ? padraoResp.value.toLowerCase() : "não avaliado";

let pmvSelecionado = document.querySelector('input[name="pmv"]:checked');
   let pmv = pmvSelecionado ? pmvSelecionado.value.toLowerCase() : "não avaliado";

   // Adiciona trabalho respiratório diretamente ao PMV
   const trabalhoResp = document.querySelector('input[name="trabalhoRespiratorio"]:checked');
   if (trabalhoResp) {
       pmv += ` ${trabalhoResp.value.toLowerCase()}`;
   }

let expansSelecionada = document.querySelector('input[name="expansibilidade"]:checked');
let expansibilidade = expansSelecionada ? expansSelecionada.value.toLowerCase() : "não avaliada";

const trabalhoRespiratorio = document.querySelector('input[name="trabalhoRespiratorio"]:checked');


let auscultaSelecionada = document.querySelector('input[name="ausculta"]:checked');
let auscultaTexto = "Ausculta pulmonar: ";

if (auscultaSelecionada) {
    // Sons pulmonares
    if (auscultaSelecionada.value === "Sons audíveis") {
        auscultaTexto += "sons pulmonares audíveis";
    } else if (auscultaSelecionada.value === "Sons reduzidos") {
        let auscultaSide = document.querySelector('input[name="auscultaSide"]:checked');
        let auscultaLocation = document.querySelector('input[name="auscultaLocation"]:checked');
        
        auscultaTexto += "sons pulmonares reduzidos";
        
        if (auscultaSide || auscultaLocation) {
            auscultaTexto += " em ";
            if (auscultaLocation) auscultaTexto += auscultaLocation.value.toLowerCase();
            if (auscultaSide && auscultaLocation) auscultaTexto += " de ";
            if (auscultaSide) auscultaTexto += auscultaSide.value.toLowerCase();
        }
    } else if (auscultaSelecionada.value === "Sons ausentes") {
        auscultaTexto += "sons pulmonares ausentes";
    }
    
    // Ruídos adicionais
    let ruidosSelecionado = document.querySelector('input[name="ruidos"]:checked');
    if (ruidosSelecionado) {
        if (ruidosSelecionado.value === "com ruídos") {
            let tiposRuidos = Array.from(document.querySelectorAll('input[name="tipoRuido"]:checked')).map(el => el.value.toLowerCase());
            if (tiposRuidos.length > 0) {
                auscultaTexto += `, com ${tiposRuidos.join(", ")}`;
            }
        } else {
            auscultaTexto += ", sem ruídos";
        }
    }
} else {
    auscultaTexto += "não avaliada";
}

evolucao += `Padrão respiratório: ${padraoRespiratorio}, PMV: ${pmv}, expansibilidade torácica: ${expansibilidade}, ${auscultaTexto}.\n`;

// Mecânica Ventilatória
const pimax = document.getElementById("pimax")?.value;
const pemax = document.getElementById("pemax")?.value;
if (pimax || pemax) {
    evolucao += `Monovacuometria: `;
    if (pimax) evolucao += `PiMax: ${pimax}cmH2O`;
    if (pimax && pemax) evolucao += `, `;
    if (pemax) evolucao += `PeMax: ${pemax}cmH2O`;
    evolucao += `. `;
}

const vcVent = document.getElementById("vcVentilometria")?.value;
const frVent = document.getElementById("frVentilometria")?.value;
const vm = document.getElementById("vm")?.value;
if (vcVent || frVent || vm) {
    evolucao += `Ventilometria: `;
    if (vcVent) evolucao += `VC: ${vcVent}ml`;
    if (frVent) evolucao += `, FR: ${frVent}irpm`;
    if (vm) evolucao += `, VM: ${vm}L/min`;
    evolucao += `.`;
}

// Observações adicionais do sistema respiratório
const obsResp = document.getElementById("obsRespiratorio")?.value.trim();
if (obsResp) {
    evolucao += `Obs: ${obsResp}\n`;
}

// Marcos Respiratórios
const marcosResp = document.getElementById("marcosRespiratorios")?.value.trim();
if (marcosResp) {
    evolucao += `Marcos Respiratórios: ${marcosResp}\n`;
}

    // Hemogasometria
let hgaSelecionada = document.querySelector('input[name="hga"]:checked');
if (hgaSelecionada && hgaSelecionada.value === "Com HGA") {
    let ph = document.getElementById("ph")?.value || "não avaliado";
    let pao2 = document.getElementById("pao2")?.value || "não avaliado";
    let pco2 = document.getElementById("pco2")?.value || "não avaliado";
    let hco3 = document.getElementById("hco3")?.value || "não avaliado";
    let lac = document.getElementById("lac")?.value || "não avaliado";
    let pf = document.getElementById("pf")?.value || "não avaliado";
    
    evolucao += `Hemogasometria arterial: pH: ${ph}, PaO₂: ${pao2}mmHg, PCO₂: ${pco2}mmHg, HCO₃: ${hco3}mEq/L, Lac: ${lac}, P/F: ${pf}\n\n`;  // <- \n\n adicionado aqui
}

// Condição neuro musculoesquelética e aparelho cardiovascular no mesmo parágrafo
let neuroTexto = `Condição neuro musculoesquelética: `;
    const forcaMuscular = document.querySelector('input[name="forcaMuscular"]:checked');
    
    if (forcaMuscular) {
        const amplitudeMovimento = document.querySelector('input[name="amplitudeMovimento"]:checked');
        if (amplitudeMovimento && amplitudeMovimento.value === "Reduzidas") {
            const admMSD = document.querySelector('select[name="admMSD"]')?.value;
            const admMSE = document.querySelector('select[name="admMSE"]')?.value;
            const admMID = document.querySelector('select[name="admMID"]')?.value;
            const admMIE = document.querySelector('select[name="admMIE"]')?.value;
            const admTronco = document.querySelector('select[name="admTronco"]')?.value;
            
            let amplitudes = [];
            if (admMSD !== "ADM Normal") amplitudes.push(`MSD (${admMSD.toLowerCase()})`);
            if (admMSE !== "ADM Normal") amplitudes.push(`MSE (${admMSE.toLowerCase()})`);
            if (admMID !== "ADM Normal") amplitudes.push(`MID (${admMID.toLowerCase()})`);
            if (admMIE !== "ADM Normal") amplitudes.push(`MIE (${admMIE.toLowerCase()})`);
            if (admTronco !== "ADM Normal") amplitudes.push(`tronco (${admTronco.toLowerCase()})`);
            
            neuroTexto += `Amplitudes de movimento reduzidas em ${amplitudes.join(", ")}. `;
        } else {
            neuroTexto += `Amplitudes de movimento preservadas. `;
        }

        // Verificar amputações
        const amputacao = document.querySelector('input[name="amputacao"]:checked');
        if (amputacao && amputacao.value === "Sim") {
            const locaisAmputacao = Array.from(document.querySelectorAll('input[name="localAmputacao"]:checked')).map(el => {
                const tipo = document.querySelector(`select[name="tipoAmputacao${el.value}"]`)?.value;
                return tipo ? `${el.value} (${tipo.toLowerCase()})` : el.value;
            });
            
            if (locaisAmputacao.length > 0) {
                neuroTexto += `Amputações presentes: ${locaisAmputacao.join(", ")}. `;
            }
        }
        
        if (forcaMuscular.value === "MRC") {
            let totalMRC = document.getElementById("totalMRCInput")?.value || "0";
            let interpretation = document.getElementById("mrcInterpretation")?.textContent.toLowerCase() || "não avaliado";
            neuroTexto += `Força muscular avaliada pela escala MRC: ${totalMRC}/60 (${interpretation}). `;
        } else if (forcaMuscular.value === "NaoPossivelAvaliar") {
            const motivos = Array.from(document.querySelectorAll('input[name="motivoNaoAvaliar"]:checked')).map(el => el.value.replace("Nivel", "nível").toLowerCase());
            neuroTexto += `Força muscular não possível avaliar: ${motivos.join(", ")}. `;
        }
        
        const deficitMotor = document.querySelector('input[name="deficitMotor"]:checked');
        const deficitSensorial = document.querySelector('input[name="deficitSensorial"]:checked');
        
        neuroTexto += `Presença de déficit motor: ${deficitMotor ? deficitMotor.value.toLowerCase() : "não"}. `;
        
        if (deficitMotor && deficitMotor.value === "Sim") {
            const alteracaoTonus = document.querySelector('input[name="alteracaoTonus"]:checked');if (alteracaoTonus && alteracaoTonus.value !== "Sem alteração") {
    const locaisTonus = Array.from(document.querySelectorAll('input[name="localTonus"]:checked')).map(el => {
    if (el.value === "MSD") return "MSD ";
    if (el.value === "MSE") return "MSE ";
    if (el.value === "MID") return "MID ";
    if (el.value === "MIE") return "MIE ";
    return el.value;
});
    
    neuroTexto += `Tônus ${alteracaoTonus.value.toLowerCase()}${locaisTonus.length > 0 ? ` em ${locaisTonus.join(", ")}` : ''}. `;
}
            
            const alteracaoControleMotor = document.querySelector('input[name="alteracaoControleMotor"]:checked');
            if (alteracaoControleMotor && alteracaoControleMotor.value !== "Sem alteração") {
    neuroTexto += `Alterações no controle motor: ${alteracaoControleMotor.value.toLowerCase()}`;
    
    if (alteracaoControleMotor.value === "Plegia") {
        const localParalisia = Array.from(document.querySelectorAll('input[name="localParalisia"]:checked')).map(el => {
            let articulacoes = [];
            if (el.value === "MSD") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoMSD"]:checked')).map(a => a.value);
            } else if (el.value === "MSE") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoMSE"]:checked')).map(a => a.value);
            } else if (el.value === "MID") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoMID"]:checked')).map(a => a.value);
            } else if (el.value === "MIE") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoMIE"]:checked')).map(a => a.value);
            }
            
            return articulacoes.length > 0 
                ? `${el.value} (${articulacoes.join(", ")})` 
                : el.value;
        });
        
        if (localParalisia.length > 0) {
            neuroTexto += ` (localização: ${localParalisia.join(", ")})`;
        }
    } else if (alteracaoControleMotor.value === "Paresia") {
        const localFraqueza = Array.from(document.querySelectorAll('input[name="localFraqueza"]:checked')).map(el => {
            let articulacoes = [];
            if (el.value === "MSD") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoFraquezaMSD"]:checked')).map(a => a.value);
            } else if (el.value === "MSE") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoFraquezaMSE"]:checked')).map(a => a.value);
            } else if (el.value === "MID") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoFraquezaMID"]:checked')).map(a => a.value);
            } else if (el.value === "MIE") {
                articulacoes = Array.from(document.querySelectorAll('input[name="articulacaoFraquezaMIE"]:checked')).map(a => a.value);
            }
            
            return articulacoes.length > 0 
                ? `${el.value} (${articulacoes.join(", ")})` 
                : el.value;
        });
        
        if (localFraqueza.length > 0) {
            neuroTexto += ` (localização: ${localFraqueza.join(", ")})`;
        }
    }
    
    neuroTexto += ". ";
}
        }
        
        neuroTexto += `Presença de déficit sensorial: ${deficitSensorial ? deficitSensorial.value.toLowerCase() : "não"}.`;
        
        if (deficitSensorial && deficitSensorial.value === "Sim") {
            const tiposDeficit = Array.from(document.querySelectorAll('input[name="deficitSensorialTipo"]:checked')).map(el => el.value.toLowerCase());
            if (tiposDeficit.length > 0) {
                neuroTexto += ` Tipos de déficit sensorial: `;
                
                tiposDeficit.forEach(tipo => {
                    neuroTexto += `${tipo}`;
                    
                    if (tipo === "propriocepção alterada") {
                        const local = Array.from(document.querySelectorAll('input[name="localPropriocepcao"]:checked')).map(el => el.value.toLowerCase());
                        if (local.length > 0) neuroTexto += ` (${local.join(", ")})`;
                    } else if (tipo === "cinetesia prejudicada") {
                        const local = Array.from(document.querySelectorAll('input[name="localCinetesia"]:checked')).map(el => el.value.toLowerCase());
                        if (local.length > 0) neuroTexto += ` (${local.join(", ")})`;
                    } else if (tipo === "barognosia alterada") {
                        const local = Array.from(document.querySelectorAll('input[name="localBarognosia"]:checked')).map(el => el.value.toLowerCase());
                        if (local.length > 0) neuroTexto += ` (${local.join(", ")})`;
                    }
                    
                    neuroTexto += "; ";
                });
                
                neuroTexto = neuroTexto.slice(0, -2) + ". ";
            }
        }
    }
    

// Observações adicionais neuro musculoesqueléticas
const obsNeuro = document.getElementById("obsNeuroMusculo")?.value.trim();
if (obsNeuro) {
    evolucao += `Obs: ${obsNeuro}\n`;
}

    // Aparelho cardiovascular
let cardioTexto = `Aparelho cardiovascular: `;
    
// Perfusão
const perfusao = document.querySelector('input[name="perfusao"]:checked');
cardioTexto += `Perfusão periférica ${perfusao ? perfusao.value.toLowerCase() : 'não avaliada'}. `;

// Edema
const edema = document.querySelector('input[name="edema"]:checked');
if (edema && edema.value === "Presente") {
    const grauEdema = document.querySelector('input[name="grauEdema"]:checked');
    const locaisEdema = Array.from(document.querySelectorAll('input[name="localEdema"]:checked')).map(el => el.value);
    
    if (grauEdema && locaisEdema.length > 0) {
        cardioTexto += `Edema ${grauEdema.value} em ${locaisEdema.join(" e ")}. `;
    } else if (grauEdema) {
        cardioTexto += `Edema ${grauEdema.value}. `;
    } else if (locaisEdema.length > 0) {
        cardioTexto += `Edema em ${locaisEdema.join(" e ")}. `;
    }
} else {
    cardioTexto += `Edema ausente. `;
}

// Outros achados
const outrosCardio = Array.from(document.querySelectorAll('input[name="outrosCardio"]:checked')).map(el => el.value.toLowerCase());
if (outrosCardio.length > 0) {
    cardioTexto += `${outrosCardio.join(", ")}.`;
}

// Juntando neuro e cardio no mesmo parágrafo
evolucao += "\n" + neuroTexto + " " + cardioTexto + "\n\n";
    

    // Capacidade funcional
    let capacidadePrevia = document.querySelector('input[name="capacidadePrevia"]:checked')?.value.toLowerCase() || "não avaliado";
    let capacidadeFuncionalTexto = `Capacidade funcional: Prévia ao internamento: ${capacidadePrevia}. `;

    let fssSelecionado = document.querySelector('input[name="escalaFSS"]:checked');
    if (fssSelecionado?.value === "Aplicavel") {
        let fssScore = document.getElementById("fssScore")?.value || "não avaliado";
        let fssInterpretation = document.getElementById("fssInterpretation")?.textContent.toLowerCase() || "não avaliado";
        capacidadeFuncionalTexto += `Escala FSS atual: ${fssScore}/35 (${fssInterpretation}).`;
    } else {
        let motivos = Array.from(document.querySelectorAll('input[name="motivoNaoAplicarFSS"]:checked')).map(el => el.value.replace("Nivel", "nível").toLowerCase());
        capacidadeFuncionalTexto += `Escala FSS não aplicável: ${motivos.join(", ")}.`;
    }
    evolucao += capacidadeFuncionalTexto + "\n\n";

    // Plano Terapêutico
    let planoTerapeutico = Array.from(document.querySelectorAll('input[name="planoTerapeutico"]:checked')).map(el => el.value.toLowerCase());
    if (planoTerapeutico.length > 0) {
        evolucao += `Plano terapêutico:\n- ${planoTerapeutico.join("\n- ")}\n\n`;
    }

    // Condutas
    // ===== NOVO BLOCO DE CONDUTAS - INÍCIO ===== //
   // Prioridade 1: Monitorização
   const monitorizacao = Array.from(document.querySelectorAll('input[name="condutaMonitorizacao"]:checked'))
                             .map(el => el.value);

   // Prioridade 2: Avaliações
   const avaliacoes = Array.from(document.querySelectorAll('input[name="condutaAvaliacao"]:checked'))
                         .map(el => el.value);

   // Prioridade 3: Gerenciamento
   const gerenciamento = Array.from(document.querySelectorAll('input[name="condutaGerenciamento"]:checked'))
                            .map(el => el.value);

   // Prioridade 4: Intervenções Respiratórias
   const intervRespiratorias = Array.from(document.querySelectorAll('input[name="condutaRespiratoria"]:checked'))
                                  .map(el => {
                                      if (el.value === "Terapia de Higiene Brônquica") {
                                          const quant = document.getElementById("quantidadeSecrecao")?.value || "n/a";
                                          const aspecto = document.getElementById("aspectoSecrecao")?.value || "n/a";
                                          return `${el.value} (${quant}, ${aspecto})`;
                                      }
                                      if (el.value === "Troca de Filtro") {
                                          const motivo = document.querySelector('input[name="motivoTrocaFiltro"]:checked');
                                          return motivo ? `${el.value} (${motivo.value})` : el.value;
                                      }
                                      if (el.value === "Troca de Trach Care") {
                                          const motivo = document.querySelector('input[name="motivoTrocaTrach"]:checked');
                                          return motivo ? `${el.value} (${motivo.value})` : el.value;
                                      }
                                      return el.value;
                                  });

   // Prioridade 5: Intervenções Motoras
   const intervMotoras = Array.from(document.querySelectorAll('input[name="condutaMotora"]:checked'))
    .map(el => el.value)
    .sort((a, b) => ordemCondutas.indexOf(a) - ordemCondutas.indexOf(b));

   // Prioridade 6: Posicionamento
   const posicionamento = Array.from(document.querySelectorAll('input[name="condutaPosicionamento"]:checked'))
                             .map(el => el.value);

   // Junta TUDO na ordem de prioridade
   const todasCondutas = [
       ...monitorizacao,
       ...avaliacoes,
       ...gerenciamento,
       ...intervRespiratorias,
       ...intervMotoras,
       ...posicionamento
   ];

   if (todasCondutas.length > 0) {
    evolucao += `Condutas realizadas: ${todasCondutas.join(", ")}\n`;
    
    // Marcos de Mobilização
    const marcosMobilizacao = document.getElementById("marcosMobilizacao")?.value.trim();
    if (marcosMobilizacao) {
        evolucao += `Marcos de Mobilização: ${marcosMobilizacao}\n`;
    }
    
    evolucao += `Atendimento finalizado sem intercorrências.\n\n`;
}
   
    // Códigos de cobrança
    const codigosCobranca = document.querySelector('input[name="codigosCobranca"]:checked');
    if (codigosCobranca && codigosCobranca.value === "Sim") {
        evolucao += `\nCódigos de cobrança: ${document.getElementById("codigosText")?.textContent.replace("Códigos: ", "") || "não especificados"}\n`;
    }

    // Atualiza o textarea com o texto gerado
    document.getElementById("textoEvolucao").value = ajustarGenero(evolucao);
}

        function calcularPAM(pa) {
            const pamSpan = document.getElementById("pam");
            if (!pa || !pa.includes('/')) {
                pamSpan.textContent = "";
                return;
            }
            
            const partes = pa.split('/');
            const pas = parseInt(partes[0]);
            const pad = parseInt(partes[1]);
            
            if (isNaN(pas) || isNaN(pad)) {
                pamSpan.textContent = "";
                return;
            }
            
            // Fórmula: PAM = PAD + (PAS - PAD)/3
            const pam = Math.round(pad + (pas - pad)/3);
            pamSpan.textContent = `(${pam})`;
        }

        function copiarTexto() {
    const textoEvolucao = document.getElementById("textoEvolucao");
    textoEvolucao.select();
    textoEvolucao.setSelectionRange(0, 99999);
    navigator.clipboard.writeText(textoEvolucao.value)
        .then(() => alert("Texto copiado com sucesso!"))
        .catch(err => {
            console.error("Erro ao copiar: ", err);
            alert("Falha ao copiar o texto.");
        });
}

        // Função para mostrar os códigos
        function mostrarCodigosCobranca() {
            document.getElementById("codigosCobrancaContainer").style.display = "block";
            atualizarCodigosCobranca(); // Atualiza os códigos ao clicar em "Sim"
        }

        // Função para esconder os códigos
        function esconderCodigosCobranca() {
            document.getElementById("codigosCobrancaContainer").style.display = "none";
        }

        // Função para atualizar os códigos conforme UTI
function atualizarCodigosCobranca() {
    const utiSelecionada = document.getElementById("uti").value;
    let codigos;
    
    switch(utiSelecionada) {
        case "GERAL 1":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.05.001-9/ 03.02.04.005-6/ 03.02.04.003-0";
            break;
        case "CARDIOVASCULAR":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.05.001-9/ 03.02.04.005-6/ 03.02.04.003-0";
            break;
        case "CIRÚRGICA":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.05.001-9/ 03.02.04.005-6/ 03.02.04.003-0";
            break;
        case "GERAL 2":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.05.001-9/ 03.02.04.005-6/ 03.02.04.003-0";
            break;
        case "NEURO":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.06.005-7/ 03.02.05.001-9/ 03.02.04.003-0/ 03.02.04.005-6";
            break;
        case "PEDI":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.04.005-6/ 03.02.06.003-0";
            break;
        case "NEO":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.04.005-6/ 03.02.06.003-0";
            break;
        case "ONCO-HEMATO":
            codigos = "03.02.04.001-3/ 03.02.06.002-2/ 03.02.05.003-5/ 03.02.04.004-8/ 03.02.05.001-9/ 03.02.04.005-6/ 03.02.04.003-0";
            break;
        default:
            codigos = "03.02.04.001-3/ 03.02.05.003-5/ 03.02.06.002-2/ 03.02.04.003-0/ 03.02.04.004-8/ 03.02.05.001-9";
    }
    
    document.getElementById("codigosText").textContent = `Códigos: ${codigos}`;
}

        // Atualiza os códigos quando UTI ou turno são alterados
        document.getElementById("uti").addEventListener("change", function() {
            if (document.querySelector('input[name="codigosCobranca"]:checked')?.value === "Sim") {
                atualizarCodigosCobranca();
            }
        });

        document.getElementById("turno").addEventListener("change", function() {
            if (document.querySelector('input[name="codigosCobranca"]:checked')?.value === "Sim") {
                atualizarCodigosCobranca();
            }
        });

        // Funções para a nova seção cardiovascular
        function mostrarDetalhesEdema() {
            document.getElementById("detalhesEdema").style.display = "block";
        }

        function esconderDetalhesEdema() {
            document.getElementById("detalhesEdema").style.display = "none";
        }

/* ===== [INÍCIO - CÓDIGO GLASGOW] ===== */
// Atualizar visibilidade dos componentes
function atualizarComponentesGlasgow() {
    const semSedacao = document.querySelector('input[name="sedacao"]:checked')?.value === "Não";
    document.getElementById("glasgowComponents").style.display = semSedacao ? "flex" : "none";
}

// Calcular total automaticamente
function calcularGlasgowTotal() {
    const ocular = parseInt(document.getElementById("glasgowOcular").value) || 0;
    const verbal = parseInt(document.getElementById("glasgowVerbal").value) || 0;
    const motora = parseInt(document.getElementById("glasgowMotora").value) || 0;
    document.getElementById("glasgow").value = ocular + verbal + motora;
}

// Configurar eventos
document.querySelectorAll('input[name="sedacao"]').forEach(radio => {
    radio.addEventListener('change', atualizarComponentesGlasgow);
});

["glasgowOcular", "glasgowVerbal", "glasgowMotora"].forEach(id => {
    document.getElementById(id).addEventListener("change", calcularGlasgowTotal);
});
/* ===== [FIM - CÓDIGO GLASGOW] ===== */

        // Funções para amputações
        function mostrarOpcoesAmputacao() {
            document.getElementById("opcoesAmputacao").style.display = "block";
        }

        function esconderOpcoesAmputacao() {
            document.getElementById("opcoesAmputacao").style.display = "none";
        }

        function mostrarEscalaEVA() {
            document.getElementById("escalaEVAContainer").style.display = "block";
        }

        function esconderEscalaEVA() {
            document.getElementById("escalaEVAContainer").style.display = "none";
            document.getElementById("eva").value = 0;
            document.getElementById("evaValue").textContent = "0";
        }
        
        function mostrarMecanicaPulmonar() {
    document.getElementById("detalhesMecanicaPulmonar").style.display = "block";
}

function esconderMecanicaPulmonar() {
    document.getElementById("detalhesMecanicaPulmonar").style.display = "none";
}

/* ===== [FUNÇÕES GLASGOW] ===== */
function calcularGlasgow() {
    const ocular = parseInt(document.getElementById("glasgowOcular").value) || 0;
    const verbal = parseInt(document.getElementById("glasgowVerbal").value) || 0;
    const motora = parseInt(document.getElementById("glasgowMotora").value) || 0;
    const total = ocular + verbal + motora;
    document.getElementById("glasgow").value = total > 0 ? total : "";
}

function atualizarComponentesGlasgow() {
    const semSedacao = document.querySelector('input[name="sedacao"]:checked')?.value === "Não";
    const glasgowComponents = document.getElementById("glasgowComponents");
    
    if (semSedacao) {
        glasgowComponents.style.display = "flex";
        // Define valores padrão
        document.getElementById("glasgowOcular").value = "4";
        document.getElementById("glasgowVerbal").value = "5";
        document.getElementById("glasgowMotora").value = "6";
        calcularGlasgow();
    } else {
        glasgowComponents.style.display = "none";
    }
}

// Atualiza a função mostrarOpcoesSedacao existente
function mostrarOpcoesSedacao() {
    let sedacao = document.querySelector('input[name="sedacao"]:checked');
    if(sedacao) {
        if (sedacao.value === "Sim") {
            document.getElementById("opcoesSedacao").style.display = "block";
            document.getElementById("opcoesGlasgow").style.display = "none";
        } else if (sedacao.value === "Narcose Anestésica") {
            document.getElementById("opcoesSedacao").style.display = "none";
            document.getElementById("opcoesGlasgow").style.display = "none";
        } else {
            document.getElementById("opcoesSedacao").style.display = "none";
            document.getElementById("opcoesGlasgow").style.display = "block";
            atualizarComponentesGlasgow(); // Mostra os componentes
        }
    }
}
        
        // Mostrar códigos automaticamente
mostrarCodigosCobranca();

        // Inicialização ao carregar a página
        document.addEventListener('DOMContentLoaded', function() {

// Configura eventos para os componentes do Glasgow
["glasgowOcular", "glasgowVerbal", "glasgowMotora"].forEach(id => {
    document.getElementById(id).addEventListener("change", calcularGlasgow);
});

// Configura evento para a sedação
document.querySelectorAll('input[name="sedacao"]').forEach(radio => {
    radio.addEventListener('change', function() {
        mostrarOpcoesSedacao();
        atualizarComponentesGlasgow();
    });
});

// Inicializa os valores do Glasgow
document.getElementById("glasgowOcular").value = "4";
document.getElementById("glasgowVerbal").value = "5";
document.getElementById("glasgowMotora").value = "6";
calcularGlasgow();
atualizarComponentesGlasgow(); // Verifica o estado inicial

            // Configuração da data
            const today = new Date();
            document.getElementById('dataEvolucao').value = `${String(today.getDate()).padStart(2, '0')}/${String(today.getMonth() + 1).padStart(2, '0')}/${today.getFullYear()}`;

            // Máscara de formatação (DD/MM/AAAA)
            document.getElementById('dataEvolucao').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 2) value = `${value.substring(0, 2)}/${value.substring(2)}`;
                if (value.length > 5) value = `${value.substring(0, 5)}/${value.substring(5, 9)}`;
                e.target.value = value;
            });

            // Event listener para mostrar/ocultar o campo HDA conforme o tipo de documento
            document.getElementById('tipoDocumento').addEventListener('change', function() {
                const tipo = this.value;
                document.getElementById('hdaContainer').style.display = tipo === 'admissao' ? 'block' : 'none';
            });

            // Inicialização das opções respiratórias
            atualizarOpcoesRespiratorias();
            
            document.getElementById("mecanicaPulmonarContainer").style.display = "block";
            
            // Event listeners para cálculo do ROX
            document.getElementById("spo2").addEventListener("input", calcularROX);
            document.getElementById("fr").addEventListener("input", calcularROX);
            document.getElementById("fio2CNAF").addEventListener("input", calcularROX);
            
            // Event listeners para cálculo do HACOR
            document.getElementById("fc").addEventListener("input", calcularHACOR);
            document.getElementById("fr").addEventListener("input", calcularHACOR);
            document.getElementById("glasgow").addEventListener("change", calcularHACOR);
            document.getElementById("ph").addEventListener("input", calcularHACOR);
            document.getElementById("pao2").addEventListener("input", calcularHACOR);

// Função para calcular Volume Minuto automaticamente
function calcularVolumeMinuto() {
    const vc = parseFloat(document.getElementById("vcVentilometria").value) || 0;
    const fr = parseFloat(document.getElementById("frVentilometria").value) || 0;
    
    if (vc > 0 && fr > 0) {
        const vm = (vc * fr) / 1000; // Converte ml/min para L/min
        document.getElementById("vm").value = vm.toFixed(1);
    } else {
        document.getElementById("vm").value = "";
    }
}

// Adicionar event listeners para os campos de ventilometria
document.getElementById("vcVentilometria").addEventListener("input", calcularVolumeMinuto);
document.getElementById("frVentilometria").addEventListener("input", calcularVolumeMinuto);
// Event listeners para cálculo do HACOR
document.getElementById("fc").addEventListener("input", calcularHACOR);
document.getElementById("fr").addEventListener("input", calcularHACOR);
document.getElementById("glasgow").addEventListener("change", calcularHACOR);
document.getElementById("ph").addEventListener("input", calcularHACOR);
document.getElementById("pao2").addEventListener("input", calcularHACOR);
document.getElementById("fio2VNI").addEventListener("input", calcularHACOR);

// Event listener para o select do Glasgow
document.getElementById("glasgow").addEventListener("change", function() {
    let sedacao = document.querySelector('input[name="sedacao"]:checked');
    if (sedacao && sedacao.value === "Não") {
        document.getElementById("opcoesGlasgow").style.display = this.value ? "block" : "none";
    }
});

            // Expande a primeira seção por padrão
            document.querySelector('.section-header').click();
        });
        
function gerarMiniEvolucao() {
    // Data atual formatada
    const dataCompleta = document.getElementById("dataEvolucao").value || "DD/MM/AAAA";
    const data = dataCompleta.split('/').slice(0, 2).join('/') || "DD/MM";
    
    // Estado Mental (com abreviações)
    let estadoMental = "";
    const estados = document.querySelectorAll('input[name="estadoComportamental"]:checked');
    
    if (estados.length > 0) {
        const termos = Array.from(estados).map(el => {
            switch(el.value) {
                case "desperto": return "desperto";
                case "sonolento": return "sonolento";
                case "comatoso": return "comatoso";
                case "agitado": return "agitado";
                case "orientado": return "orientado";
                case "confuso": return "confuso";
                case "responsivo": return "responsivo";
                case "hipoativo": return "hipoativo";
                default: return el.value.toLowerCase();
            }
        });
        estadoMental = termos.join(", ");
    } else {
        estadoMental = "não avaliado";
    }

    // Sedação
    const sedacao = document.querySelector('input[name="sedacao"]:checked');
    if (sedacao && sedacao.value === "Sim") {
        const sedativos = Array.from(document.querySelectorAll('input[name="sedativos"]:checked')).map(el => {
            // Abreviações para sedativos
            switch(el.value) {
                case "Propofol": return "PROP";
                case "Midazolam": return "MID";
                case "Fentanil": return "FENT";
                case "Precedex": return "DEX";
                default: return el.value.substring(0, 4);
            }
        });
        estadoMental = sedativos.length > 0 ? `sedado c/ ${sedativos.join("+")}` : "sedado";
    }

    // Estado Hemodinâmico (com abreviações)
    let hdn = "";
    const hemodinamica = document.querySelector('input[name="hemodinamica"]:checked');
    if (hemodinamica) {
        hdn = hemodinamica.value.includes("estável") ? "HDN estável" :
              hemodinamica.value.includes("compensada") ? "HDN compensada" :
              "HDN instável";
    }

    // Drogas vasoativas (com abreviações)
    const drogasVasoativas = document.querySelector('input[name="drogasVasoativas"]:checked');
    if (drogasVasoativas && drogasVasoativas.value === "com uso de drogas vasoativas") {
        const drogas = Array.from(document.querySelectorAll('input[name="drogas"]:checked')).map(el => {
            switch(el.value) {
                case "Noradrenalina": return "NORA";
                case "Dobutamina": return "DOBU";
                case "Vasopressina": return "VASO";
                case "Nipride": return "NIP";
                default: return el.value.substring(0, 4);
            }
        });
        if (drogas.length > 0) {
            hdn += ` c/ ${drogas.join("+")}`;
        }
    }

    // Sistema Respiratório (com abreviações)
let resp = "";
const respiratorio = document.getElementById("sistemaRespiratorio").value;

if (respiratorio === "vni") {
    const modoVNI = document.querySelector('input[name="modoVNI"]:checked');
    const epap = document.getElementById("epap").value || "?";
    const ipap = document.getElementById("ipap").value || "?";
    const fio2 = document.getElementById("fio2VNI").value || "?";
    resp = `VNI ${modoVNI?.value || '?'} ${ipap}/${epap} FiO2 ${fio2}%`;
} 
else if (respiratorio === "espontanea") {
    const opcaoEspontanea = document.querySelector('input[name="opcaoEspontanea"]:checked');
    if (opcaoEspontanea) {
        if (opcaoEspontanea.value === "Máscara O2") {
            const fluxo = document.getElementById("fluxo").value || "?";
            resp = `VE c/ máscara ${fluxo}L/min`;
        } 
        else if (opcaoEspontanea.value === "CNAF") {
            const fluxo = document.getElementById("fluxo").value || "?";
            const fio2 = document.getElementById("fio2CNAF").value || "?";
            resp = `CNAF ${fluxo}L/min FiO2 ${fio2}%`;
        } 
        else if (opcaoEspontanea.value === "Ar ambiente ") {
            resp = "VE ao AA";
        }
        else {
            resp = `VE c/ ${opcaoEspontanea.value.toLowerCase()}`;
        }
    }
} 
else if (respiratorio === "VM") {
    const modoVM = document.querySelector('input[name="modoVM"]:checked');
    const viaAerea = document.querySelector('input[name="viaAerea"]:checked');
    if (modoVM && viaAerea) {
        resp = `VM ${modoVM.value} via ${viaAerea.value}`;
        
        if (modoVM.value === "PSV") {
            const psup = document.getElementById("psup").value || "?";
            resp += ` ${psup}`;
        }
    }
}

// CORREÇÃO: Trabalho Respiratório - verifica exatamente o que foi selecionado
const trabalhoResp = document.querySelector('input[name="trabalhoRespiratorio"]:checked');
if (trabalhoResp) {
    if (trabalhoResp.value.includes("Sem sinais")) {
        resp += " s/ ↑WOB";
    } else if (trabalhoResp.value.includes("Com aumento")) {
        resp += " c/ ↑WOB";
    }
}
    // Ausculta Pulmonar (formatada conforme solicitado)
let ap = "AP ";
const auscultaSelecionada = document.querySelector('input[name="ausculta"]:checked');
if (auscultaSelecionada) {
    // Sons pulmonares
    if (auscultaSelecionada.value === "Sons audíveis") {
        ap += "sons pulmonares audíveis";
    } else if (auscultaSelecionada.value === "Sons reduzidos") {
        const auscultaSide = document.querySelector('input[name="auscultaSide"]:checked');
        ap += "sons pulmonares diminuídos";
        if (auscultaSide) {
            ap += ` ${auscultaSide.value.toLowerCase()}`;
        }
    } else if (auscultaSelecionada.value === "Sons ausentes") {
        ap += "sons pulmonares ausentes";
    }

    // Ruídos adicionais
    const ruidosSelecionado = document.querySelector('input[name="ruidos"]:checked');
    if (ruidosSelecionado && ruidosSelecionado.value === "com ruídos") {
        const tiposRuidos = Array.from(document.querySelectorAll('input[name="tipoRuido"]:checked')).map(el => {
            switch(el.value) {
                case "Roncos": return "roncos";
                case "Sibilos": return "sibilos";
                case "Estertores": return "estertores";
                case "Atrito pleural": return "atrito pleural";
                default: return el.value.toLowerCase();
            }
        });
        if (tiposRuidos.length > 0) {
            ap += ` com ${tiposRuidos.join(", ")}`;
        }
    }
} else {
    ap += "não avaliada";
}

    // HGA (se disponível)
    let hga = "";
    const hgaSelecionada = document.querySelector('input[name="hga"]:checked');
    if (hgaSelecionada && hgaSelecionada.value === "Com HGA") {
        const ph = document.getElementById("ph").value || "?";
        const pao2 = document.getElementById("pao2").value || "?";
        const pco2 = document.getElementById("pco2").value || "?";
        const hco3 = document.getElementById("hco3").value || "?";
        const lac = document.getElementById("lac").value || "?";
        const pf = document.getElementById("pf").value || "?";
        
        hga = `HGA: pH ${ph}, PaO2 ${pao2}, PCO2 ${pco2}, HCO3 ${hco3}, Lac ${lac}, P/F ${pf}`;
    }

    // Condutas (resumidas)
    let condutas = [];
    const condutasRespiratorias = Array.from(document.querySelectorAll('input[name="condutaRespiratoria"]:checked'));
    const condutasMotoras = Array.from(document.querySelectorAll('input[name="condutaMotora"]:checked'));

    // Condutas respiratórias resumidas
    condutasRespiratorias.forEach(el => {
        switch(el.value) {
            case "Terapia de Higiene Brônquica": 
                const aspecto = document.getElementById("aspectoSecrecao")?.value || "?";
                condutas.push(`THB (${aspecto.substring(0, 3)})`); 
                break;
                if (el.value === "Troca de Filtro") {
    const motivo = document.querySelector('input[name="motivoTrocaFiltro"]:checked');
    return motivo ? `Troca filtro (${motivo.value})` : "Troca filtro";
}
if (el.value === "Troca de Trach Care") {
    const motivo = document.querySelector('input[name="motivoTrocaTrach"]:checked');
    return motivo ? `Troca trach care (${motivo.value})` : "Troca trach care";
}
            case "Gerenciamento de VM": condutas.push("ger VM"); break;
            case "Gerenciamento de oxigenoterapia": condutas.push("ger O2"); break;
            default: condutas.push(el.value.substring(0, 5));
        }
    });
    
    // Condutas motoras resumidas
    condutasMotoras.forEach(el => {
        switch(el.value) {
            case "Deambulação": condutas.push("deamb"); break;
            // Dentro do switch case das condutas motoras
case "Descarga de peso": condutas.push("descarga peso"); break;
case "Facilitação da marcha": condutas.push("facil marcha"); break;
case "Estímulos à linha média": condutas.push("estim linha med"); break;
case "Diagonais (PNF)": condutas.push("diagonais PNF"); break;
            case "Mobilização no leito": condutas.push("mob leito"); break;
            case "Sedestação na poltrona": condutas.push("sed poltrona"); break;
            default: condutas.push(el.value.substring(0, 5));
        }
    });

    // Montagem do texto final
    let miniEvolucao = `${data}: Pct ${estadoMental}, ${hdn}, ${resp}, ${ap}`;
    
    if (hga) miniEvolucao += `\n${hga}`;
    if (condutas.length > 0) miniEvolucao += `\nRealizado: ${condutas.join(", ")}`;
    
    // Observações relevantes (se existirem)
    const obsResp = document.getElementById("obsRespiratorio")?.value.trim();
    const obsNeuro = document.getElementById("obsNeuroMusculo")?.value.trim();
    
    if (obsResp || obsNeuro) {
        miniEvolucao += `\nObs:`;
        if (obsResp) miniEvolucao += ` ${obsResp.substring(0, 50)}${obsResp.length > 50 ? '...' : ''}`;
        if (obsNeuro) miniEvolucao += ` ${obsNeuro.substring(0, 50)}${obsNeuro.length > 50 ? '...' : ''}`;
    }

// Marcos Respiratórios (versão resumida)
const marcosResp = document.getElementById("marcosRespiratorios")?.value.trim();
if (marcosResp) {
    miniEvolucao += `\nMarcos: ${marcosResp.substring(0, 50)}${marcosResp.length > 50 ? '...' : ''}`;
}

    // Ajuste de gênero e formatação final
    miniEvolucao = ajustarGenero(miniEvolucao)
        .replace(/\s+/g, ' ') // Remove múltiplos espaços
        .replace(/\s\./g, '.') // Remove espaços antes de pontos
        .trim();

    document.getElementById("textoEvolucao").value = miniEvolucao;
}

function ajustarGenero(texto) {
    const sexo = document.querySelector('input[name="sexo"]:checked')?.value;
    if (sexo !== "Feminino") return texto;
    
    texto = texto.replace("Paciente encontrado", "Paciente encontrada");
texto = texto.replace("paciente encontrado", "paciente encontrada");
    
    const palavras = {
        "desperto": "desperta", "sonolento": "sonolenta", "comatoso": "comatosa",
        "agitado": "agitada", "orientado": "orientada", "confuso": "confusa",
        "responsivo": "responsiva", "não Responsivo": "não Responsiva",
        "hipoativo": "hipoativa", "acamado": "acama", "sedado": "sedada"
    };

    for (const [masc, fem] of Object.entries(palavras)) {
        texto = texto.replace(new RegExp(`\\b${masc}\\b`, 'gi'), fem);
    }
    return texto;
}

    </script>

<script>
  document.getElementById('hospital').textContent = sessionStorage.getItem('evolucao.hospital') || '-';
  document.getElementById('unidade').textContent = sessionStorage.getItem('evolucao.unidade') || '-';
  document.getElementById('leito').textContent = sessionStorage.getItem('evolucao.leito') || '-';
</script>

</body>
</html>
